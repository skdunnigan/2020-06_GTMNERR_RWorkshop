<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Session 2 - Wrangle Data</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/yeti.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 45px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h2 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h3 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h4 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h5 {
  padding-top: 50px;
  margin-top: -50px;
}
.section h6 {
  padding-top: 50px;
  margin-top: -50px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Integrate R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="schedule.html">Schedule</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Sessions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="introduction.html">Session 00 - Introduction</a>
    </li>
    <li>
      <a href="01-Visualize.html">Session 01 - Visualize Data</a>
    </li>
    <li>
      <a href="02-Wrangle.html">Session 02 - Wrangle Data</a>
    </li>
    <li>
      <a href="03_Join_Bind_full.html">Session 03 - Advanced Wrangling - Join and Bindings</a>
    </li>
    <li>
      <a href="04_basic_stats_full.html">Session 04 - Basic Statistical Outputs</a>
    </li>
    <li>
      <a href="05_Functions_full.html">Session 05 - Functions</a>
    </li>
    <li>
      <a href="06_Loops_full.html">Session 06 - Loops</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://rstudio.cloud/spaces/69467/join?access_code=qxliGkr1Dgd5tu8JQ8nGoRIWI9%2BOQkWRn8yStGp1">RStudio Cloud</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="code-of-conduct.html">Code of Conduct</a>
</li>
<li>
  <a href="Resources_links.html">Helpful Resources</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Session 2 - Wrangle Data</h1>

</div>


<div class="progress">
<div class="progress-bar progress-bar-striped" role="progressbar" style="width: 42%" aria-valuenow="10" aria-valuemin="0" aria-valuemax="100">

</div>
</div>
<right>
<blockquote class="blockquote text-right">
<p class="mb-0">
Data comes in many formats, but R prefers just one: tidy data.
</p>
<footer class="blockquote-footer">
Garret Grolemund, <cite title="Source Title">RStudio</cite>
</footer>
</blockquote>
<p></right></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(lubridate)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(here)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">library</span>(ggplot2)</span></code></pre></div>
<p>Sometimes, the data we’re working with is not quite ready for whatever it is we want to do. We may need to summarize the data based on some group, calculate additional parameters, subset the data, or even completely reshape it. The packages <code>dplyr</code> and <code>tidyr</code> can help with these tasks!</p>
<div id="dplyr-verbs" class="section level1">
<h1><span class="header-section-number">1</span> dplyr verbs</h1>
<p>There are three key functions in <code>dplyr</code> that are really the workhorses of the tidyverse:</p>
<ul>
<li><code>filter()</code> to subset based on rows</li>
<li><code>select()</code> to subset based on columns<br />
</li>
<li><code>mutate()</code> to add or modify values in columns</li>
</ul>
<p>We will use data downloaded from <a href="https://ebird.org">eBird</a> to explore these. <em>eBird is a large citizen-science driven project that provides a database of bird sightings around the world. It is collaborative and the data is freely accessbile to anyone.</em></p>
<p>First, let’s read in the eBird data and explore it:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>ebird &lt;-<span class="st"> </span><span class="kw">read.csv</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;eBird_workshop.csv&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a>dplyr<span class="op">::</span><span class="kw">glimpse</span>(ebird)   <span class="co"># 183,742 rows</span></span></code></pre></div>
<p>We may not talk about this in the workshop, but there are (presumably accidentally) duplicate rows in this data frame. We can see them with:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>janitor<span class="op">::</span><span class="kw">get_dupes</span>(ebird)   <span class="co"># 22 duplicates = 11 that need to go</span></span></code></pre></div>
<p>They are exact copies of other rows, not any data entry problems (although <code>janitor::get_dupes()</code> is very helpful in finding errors like mis-typing a site name), so we’ll just get rid of them by using <code>dplyr::distinct()</code> to keep only unique rows.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>ebird &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(ebird)</span>
<span id="cb4-2"><a href="#cb4-2"></a>dplyr<span class="op">::</span><span class="kw">glimpse</span>(ebird)   <span class="co"># 183,731 rows</span></span></code></pre></div>
<div id="choose-rows-filter" class="section level2">
<h2><span class="header-section-number">1.1</span> Choose <em>rows</em>: <code>filter()</code></h2>
<p>This data set has a lot of rows. We might only be interested in observations about a single bird species, or from a single state, which means we want to choose <em>rows</em>. To do this, we use the verb <code>filter()</code>. The data argument comes first, then the condition.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">filter</span>(ebird, state <span class="op">==</span><span class="st"> &quot;AK&quot;</span>)</span></code></pre></div>
<p>Alternately, we can use the pipe, which feeds the data frame resulting from everything before it into whatever is next (read it as “and then….”)<br />
We can also pipe to glimpse to explore it a little more.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="st">    </span><span class="kw">filter</span>(state <span class="op">==</span><span class="st"> &quot;AK&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">glimpse</span>()</span></code></pre></div>
<p>Notice a couple things here:</p>
<ul>
<li>We use <code>==</code> to specify an exact condition. If we were working with numbers, we could use:
<ul>
<li><code>&lt;</code><br />
</li>
<li><code>&lt;=</code><br />
</li>
<li><code>==</code><br />
</li>
<li><code>!=</code> (<strong>not</strong> equal to)<br />
</li>
<li><code>&gt;=</code><br />
</li>
<li><code>&gt;</code><br />
</li>
</ul></li>
<li>The condition specified inside <code>filter()</code> MUST return either true or false, for each row.</li>
</ul>
<p><strong>How about for multiple conditions?</strong></p>
<p>We can filter based on more than one criterion, e.g. if we want all birds from Alaska, but only in the year 2008:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="st">    </span><span class="kw">filter</span>(state <span class="op">==</span><span class="st"> &quot;AK&quot;</span>,</span>
<span id="cb7-3"><a href="#cb7-3"></a>           year <span class="op">==</span><span class="st"> </span><span class="dv">2008</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="kw">head</span>()</span></code></pre></div>
<p><strong>Note</strong>: It doesn’t matter if you select <code>state</code> or <code>year</code> first - you can do either.</p>
<p><strong>Note</strong>: if you actually need to work with the data frame later, you may consider saving these steps as new data frames!</p>
<p><strong>What if we want to look at birds from more than one state?</strong></p>
<p>There are a few ways to do this.</p>
<p>Perhaps the easiest is to make a vector of the states you’re interested in:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>my_states &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AK&quot;</span>, <span class="st">&quot;AL&quot;</span>, <span class="st">&quot;MS&quot;</span>)</span></code></pre></div>
<p>And then use <code>%in%</code> in the filter statement, to say, e.g. “any of the states <em>in</em> this vector”:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>ebird_mystates &lt;-<span class="st"> </span>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2008</span>,</span>
<span id="cb9-3"><a href="#cb9-3"></a>           state <span class="op">%in%</span><span class="st"> </span>my_states) </span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="kw">head</span>(ebird_mystates)</span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co"># make sure the states we named, and only the states we named, are represented:</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="kw">unique</span>(ebird_mystates<span class="op">$</span>state)</span></code></pre></div>
<p>You could also skip the step of naming the vector separately:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="st">    </span><span class="kw">filter</span>(year <span class="op">==</span><span class="st"> </span><span class="dv">2008</span>,</span>
<span id="cb10-3"><a href="#cb10-3"></a>           state <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;AK&quot;</span>, <span class="st">&quot;AL&quot;</span>, <span class="st">&quot;MS&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="st">    </span><span class="kw">head</span>()</span></code></pre></div>
<div id="your-turn-1" class="section level3">
<h3><span class="header-section-number">1.1.1</span> Your Turn 1</h3>
<p>How could we pull out birds in Alaska (AK), before 2010? (Hint: you can use the same symbols on year that you would use with any other numbers)</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(state <span class="op">==</span><span class="st"> &quot;AK&quot;</span>,</span>
<span id="cb11-3"><a href="#cb11-3"></a>                year <span class="op">&lt;</span><span class="st"> </span><span class="dv">2010</span>)</span></code></pre></div>
<p>How would you filter the data to contain only the species “American Coot” from MS and FL (your instructors’ states), in all years <em>except</em> 2010? Assign this object to a data frame and verify (using <code>unique()</code>) that you did it right.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>yt1 &lt;-<span class="st"> </span>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(species <span class="op">==</span><span class="st"> &quot;American Coot&quot;</span>,</span>
<span id="cb12-3"><a href="#cb12-3"></a>                state <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;MS&quot;</span>, <span class="st">&quot;FL&quot;</span>),</span>
<span id="cb12-4"><a href="#cb12-4"></a>                year <span class="op">!=</span><span class="st"> </span><span class="dv">2010</span>)</span>
<span id="cb12-5"><a href="#cb12-5"></a></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="kw">unique</span>(yt1<span class="op">$</span>species)</span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="kw">unique</span>(yt1<span class="op">$</span>state)</span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="kw">unique</span>(yt1<span class="op">$</span>year)</span></code></pre></div>
<hr />
</div>
</div>
<div id="choose-columns-select" class="section level2">
<h2><span class="header-section-number">1.2</span> Choose <em>columns</em>: <code>select()</code></h2>
<p>When you’re working with a lot of data, you may not want or need to keep all the columns you started with. In this case, <code>select()</code> is what you need.</p>
<p>The ebird data frame doesn’t have too many columns, but that makes it easy to see exactly what we’re doing! Let’s pretend we only want to keep species, state, and year. We can do this two ways:</p>
<p>First, by selecting the columns we <strong>do</strong> want to keep:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="st">    </span><span class="kw">select</span>(species, state, year) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="st">    </span><span class="kw">head</span>()</span></code></pre></div>
<p>Or second, by using a <code>-</code> in front of the columns we <strong>don’t</strong> want to keep:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>samplesize, <span class="op">-</span>presence) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="st">    </span><span class="kw">head</span>()</span></code></pre></div>
<p>Either of these can be really handy depending on what your original data frame looks like and what you’re trying to do!</p>
<p>Order <strong>does</strong> matter in <code>select()</code>; remember it didn’t matter in <code>filter()</code>. In <code>select()</code>, selections are made in the order specified - so if you want to rearrange the columns of your data, you can do it with this command!</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="st">    </span><span class="kw">select</span>(year, state, species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="st">    </span><span class="kw">head</span>()</span></code></pre></div>
<p>You can also move just one or a few columns to the beginning by specifying it/them, and then <code>everything()</code> - it keeps all other columns, in their original order:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="st">    </span><span class="kw">select</span>(year, <span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="st">    </span><span class="kw">glimpse</span>()</span></code></pre></div>
<div id="aside---helper-functions" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Aside - helper functions</h3>
<p>Sometimes you have a lot of columns that start with the same prefix, or that end with the same appended matter; maybe you want to keep all of them (or get rid of all of them). In these situations, you can use the helper functions <code>starts_with()</code> and <code>ends_with()</code>. See the <code>dplyr</code> cheatsheet for other possible helper functions.</p>
<p>In our little example, let’s keep columns whose names start with ‘s’:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="st">    </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;s&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="st">    </span><span class="kw">glimpse</span>()</span></code></pre></div>
<p>Or columns that end with ‘e’:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="st">    </span><span class="kw">select</span>(<span class="kw">ends_with</span>(<span class="st">&quot;e&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="st">    </span><span class="kw">glimpse</span>()</span></code></pre></div>
<p><em>Check out the data wrangling cheat sheet for more helper functions.</em></p>
</div>
<div id="your-turn-2" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Your Turn 2</h3>
<p>From the ebird data, subset to only include the species American Coot, from the states FL, AL, and MS. Keep only the state, year, and presence columns. What is the proper order of operations in this case?</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(species <span class="op">==</span><span class="st"> &quot;American Coot&quot;</span>,</span>
<span id="cb19-3"><a href="#cb19-3"></a>                state <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;FL&quot;</span>, <span class="st">&quot;AL&quot;</span>, <span class="st">&quot;MS&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(state, year, presence) </span>
<span id="cb19-5"><a href="#cb19-5"></a></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co"># select second because you need species and state in order to filter!</span></span></code></pre></div>
<hr />
<p><em>Setup for the next bit of the workshop</em></p>
<p>We’re going to switch datasets here, to one that’s a little more complicated: water quality data! We downloaded monitoring data from several National Estuarine Research Reserves for the year 2016, and have already winnowed it down a bit to daily averages of several parameters that we measure.</p>
<p>We will use your newfound <code>select()</code> and <code>filter()</code> skills to make it an even smaller data frame, and then we’ll learn how to calculate new columns and do group-wise summaries.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>wq &lt;-<span class="st"> </span><span class="kw">read.csv</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;daily_wq.csv&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw">glimpse</span>(wq)</span></code></pre></div>
<hr />
</div>
<div id="your-turn-3" class="section level3">
<h3><span class="header-section-number">1.2.3</span> Your Turn 3</h3>
<p>Because this is so important, I will provide working code in a chunk below. But please attempt it yourself first!!!</p>
<p>We have read in the daily water quality data for a few stations. Create a new data frame called <code>wq_trimmed</code> where, from <code>wq</code>, you:</p>
<ul>
<li><strong>Select</strong> the following columns: station_code, month, day, temp, sal, do_pct, and depth.<br />
</li>
<li><strong>Filter</strong> for rows where <code>depth</code> is <em>not</em> missing. (Hint: <code>is.na</code> is the function that checks to see if a value <em>is</em> missing. How would you look for “not” <code>is.na</code>? It’s similar to “not equal to” from above.)</li>
</ul>
</div>
<div id="your-turn-3-answer" class="section level3">
<h3><span class="header-section-number">1.2.4</span> Your Turn 3 answer</h3>
<p>Last chance to try it yourself…. but if you didn’t get it to work, run this chunk:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>wq_trimmed &lt;-<span class="st"> </span>wq <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="st">    </span><span class="kw">select</span>(station_code, month, day, temp, sal, do_pct, depth) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(depth))</span></code></pre></div>
<p>How much has been removed from the data frame?</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">dim</span>(wq)</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="kw">dim</span>(wq_trimmed)</span>
<span id="cb22-3"><a href="#cb22-3"></a></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co"># can subtract both rows and columns at once!</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="kw">dim</span>(wq) <span class="op">-</span><span class="st"> </span><span class="kw">dim</span>(wq_trimmed)</span>
<span id="cb22-6"><a href="#cb22-6"></a></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co"># why did all those rows go away?</span></span></code></pre></div>
<p>Some SWMP stations report <code>depth</code>, which is water depth above the data logger; and others report <code>level</code>, which is water surface relative to a standard datum (NAVD88). There is an important distinction that’s irrelevant for what we want to cover today, so here we have only kept the stations that report <code>depth</code>.</p>
</div>
</div>
<div id="modifying-data-frames-with-mutate" class="section level2">
<h2><span class="header-section-number">1.3</span> Modifying data frames with <code>mutate()</code></h2>
<p>It’s easy to make a new variable out of other variables in the data frame using <code>mutate()</code>. This operates on rows. Say we want to talk about water depth (or make a graph!) to the public - we might want to change the units from meters to feet. That’s simple multiplication! So here, we’ll add a column to the data frame.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>wq_trimmed <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">depth_ft =</span> depth <span class="op">*</span><span class="st"> </span><span class="fl">3.28</span>) <span class="op">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="st">  </span><span class="kw">head</span>()</span></code></pre></div>
<p>You can also use other columns. You can use them in mathematical expressions, or just combine them:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>wq_trimmed <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">monthday =</span> <span class="kw">paste</span>(month, day, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>),  <span class="co"># see ?paste for more info</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>           <span class="dt">meaningless_thing =</span> sal <span class="op">+</span><span class="st"> </span>temp) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="st">    </span><span class="kw">head</span>()</span></code></pre></div>
<p>You can even use a column immediately after creating it!</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>wq_trimmed &lt;-<span class="st"> </span>wq_trimmed <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">monthday =</span> <span class="kw">paste</span>(month, day, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>),</span>
<span id="cb25-3"><a href="#cb25-3"></a>           <span class="dt">meaningless_thing =</span> sal <span class="op">+</span><span class="st"> </span>temp,</span>
<span id="cb25-4"><a href="#cb25-4"></a>           <span class="dt">even_more_meaningless_thing =</span> meaningless_thing <span class="op">+</span><span class="st"> </span><span class="dv">5</span>) </span></code></pre></div>
<div id="your-turn-4" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Your Turn 4</h3>
<p>There are two parts to this. You can approach them separately or within the same series of pipes. Remember to save the result as the new, better, <code>wq_trimmed</code> data frame!</p>
<ol style="list-style-type: decimal">
<li>Now that we’ve started creating more columns, it might make sense to get rid of some old ones. Remove <code>monthday</code> and <code>meaningless_thing</code> from the <code>wq_trimmed</code> data frame.<br />
</li>
<li>The same person that wants to see <code>depth</code> in feet rather than meters <em>also</em> wants you to turn <code>temp</code> into Fahrenheit, from Celsius. You’ve looked up the conversion. Now create a new column, <code>temp_f</code>, with the new variable. <strong>F = (9/5)(temp in C) + 32</strong></li>
</ol>
<p>As with Your Turn 4, the answer is below. No peeking!</p>
</div>
<div id="your-turn-4-answer" class="section level3">
<h3><span class="header-section-number">1.3.2</span> Your Turn 4 answer</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>wq_trimmed &lt;-<span class="st"> </span>wq_trimmed <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="st">    </span><span class="kw">select</span>(<span class="op">-</span>monthday, <span class="op">-</span>meaningless_thing) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">temp_f =</span> (<span class="dv">9</span><span class="op">/</span><span class="dv">5</span>) <span class="op">*</span><span class="st"> </span>temp <span class="op">+</span><span class="st"> </span><span class="dv">32</span>)</span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="kw">View</span>(wq_trimmed)</span></code></pre></div>
</div>
</div>
</div>
<div id="group-wise-operations-with-group_by-and-summarize" class="section level1">
<h1><span class="header-section-number">2</span> Group-wise operations with <code>group_by()</code> and <code>summarize()</code></h1>
<p>Say we want to find out how many birds were seen by state in the ebird dataset. We can do that. These operations are also great for lumping data into daily, monthly, or yearly averages, which we’ll do on the SWMP dataset.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="st">    </span><span class="kw">group_by</span>(state) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean_presence =</span> <span class="kw">mean</span>(presence, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb27-4"><a href="#cb27-4"></a>              <span class="dt">max_presence =</span> <span class="kw">max</span>(presence, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="st">    </span><span class="kw">View</span>()</span></code></pre></div>
<p>We can also group by combinations of multiple variables:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="st">    </span><span class="kw">group_by</span>(state, species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean_presence =</span> <span class="kw">mean</span>(presence, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb28-4"><a href="#cb28-4"></a>              <span class="dt">max_presence =</span> <span class="kw">max</span>(presence, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="st">    </span><span class="kw">View</span>()</span></code></pre></div>
<div id="your-turn-5" class="section level3">
<h3><span class="header-section-number">2.0.1</span> Your Turn 5</h3>
<p>How would you group the <code>wq_trimmed</code> dataset to calculate monthly average temperature and salinity, and their standard deviations, at each station?</p>
</div>
<div id="your-turn-5-answer" class="section level3">
<h3><span class="header-section-number">2.0.2</span> Your Turn 5 answer</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>wq_trimmed <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="st">    </span><span class="kw">group_by</span>(station_code, month) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean_temp =</span> <span class="kw">mean</span>(temp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb29-4"><a href="#cb29-4"></a>              <span class="dt">sd_temp =</span> <span class="kw">sd</span>(temp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb29-5"><a href="#cb29-5"></a>              <span class="dt">mean_sal =</span> <span class="kw">mean</span>(sal, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb29-6"><a href="#cb29-6"></a>              <span class="dt">sd_sal =</span> <span class="kw">sd</span>(sal, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="st">    </span><span class="kw">View</span>()</span></code></pre></div>
</div>
<div id="aside---more-summarize-options" class="section level3">
<h3><span class="header-section-number">2.0.3</span> Aside - more summarize options</h3>
<p>There are a couple of useful variants of <code>summarize</code> for special cases. Note that you can only perform one summary function with these (so you couldn’t calculate mean <em>and</em> standard deviation in this way).</p>
<div id="summarize_all" class="section level4">
<h4><span class="header-section-number">2.0.3.1</span> <code>summarize_all()</code></h4>
<p>Applies a function to all of the non-grouping variables! (Even “day”, which isn’t meaningful, but that’s okay)</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>wq_trimmed <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="st">    </span><span class="kw">group_by</span>(station_code, month) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="st">    </span><span class="kw">summarize_all</span>(mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="st">    </span><span class="kw">View</span>()</span></code></pre></div>
</div>
<div id="summarize_at" class="section level4">
<h4><span class="header-section-number">2.0.3.2</span> <code>summarize_at()</code></h4>
<p>To choose which variables to summarize</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>wq_trimmed <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="st">    </span><span class="kw">group_by</span>(station_code, month) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="st">    </span><span class="kw">summarize_at</span>(<span class="kw">c</span>(<span class="st">&quot;temp&quot;</span>, <span class="st">&quot;sal&quot;</span>), mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb31-4"><a href="#cb31-4"></a><span class="st">    </span><span class="kw">View</span>()</span></code></pre></div>
</div>
</div>
</div>
<div id="sort" class="section level1">
<h1><span class="header-section-number">3</span> Sort</h1>
<p>You can also sort your data frame (or its summary) using <code>arrange()</code>. Let’s put our ebird summary in order by species, then state:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="st">    </span><span class="kw">group_by</span>(state, species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean_presence =</span> <span class="kw">mean</span>(presence, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb32-4"><a href="#cb32-4"></a>              <span class="dt">max_presence =</span> <span class="kw">max</span>(presence, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="st">    </span><span class="kw">arrange</span>(species, state) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="st">    </span><span class="kw">View</span>()</span></code></pre></div>
<p>Or put it in order by <code>max_presence</code>:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="st">    </span><span class="kw">group_by</span>(state, species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-3"><a href="#cb33-3"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean_presence =</span> <span class="kw">mean</span>(presence, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb33-4"><a href="#cb33-4"></a>              <span class="dt">max_presence =</span> <span class="kw">max</span>(presence, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-5"><a href="#cb33-5"></a><span class="st">    </span><span class="kw">arrange</span>(max_presence) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="st">    </span><span class="kw">View</span>()</span></code></pre></div>
<p>If you want the highest number at the top instead, use <code>desc()</code>:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>ebird <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="st">    </span><span class="kw">group_by</span>(state, species) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean_presence =</span> <span class="kw">mean</span>(presence, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb34-4"><a href="#cb34-4"></a>              <span class="dt">max_presence =</span> <span class="kw">max</span>(presence, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="st">    </span><span class="kw">arrange</span>(<span class="kw">desc</span>(max_presence)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="st">    </span><span class="kw">View</span>()</span></code></pre></div>
<div id="your-turn-6" class="section level3">
<h3><span class="header-section-number">3.0.1</span> Your Turn 6</h3>
<p>Use the <code>wq_trimmed</code> data frame. Calculate monthly average temp, sal, and do_pct (at least - more variables if you like) <em>for each station</em>. Make a scatterplot using any two of these variables. Use what you’ve learned about <code>ggplot2</code>’s options to adjust the look and feel of the graph. Is the relationship what you expected it to be? Does it vary by site?</p>
<p>Here’s one possible way to go about it. You could also make a new data frame of the summary variables, and use that in a separate call to <code>ggplot</code>.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>wq_trimmed <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-2"><a href="#cb35-2"></a><span class="st">    </span><span class="kw">group_by</span>(station_code, month) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="st">    </span><span class="kw">summarize_all</span>(mean, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="st">    </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sal, <span class="dt">y =</span> do_pct, <span class="dt">col =</span> station_code), </span>
<span id="cb35-6"><a href="#cb35-6"></a>               <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb35-7"><a href="#cb35-7"></a><span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb35-8"><a href="#cb35-8"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>station_code)</span></code></pre></div>
</div>
</div>
<div id="reshaping-data-with-tidyr" class="section level1">
<h1><span class="header-section-number">4</span> Reshaping data with <code>tidyr</code></h1>
<right>
<blockquote class="blockquote text-right">
<p class="mb-0">
Tidy data sets are all alike; but every messy data set is messy in its own way.
</p>
<footer class="blockquote-footer">
Hadley Wickham, <cite title="Source Title">RStudio</cite>
</footer>
</blockquote>
<p></right></p>
<p>Run the chunk below to “reset” each of the tester data frames</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># load and clean up some data files we&#39;ve already been working with</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>ebird &lt;-<span class="st"> </span><span class="kw">read.csv</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;eBird_workshop.csv&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb36-3"><a href="#cb36-3"></a>ebird &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">distinct</span>(ebird)</span>
<span id="cb36-4"><a href="#cb36-4"></a></span>
<span id="cb36-5"><a href="#cb36-5"></a>wq &lt;-<span class="st"> </span><span class="kw">read.csv</span>(here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;daily_wq.csv&quot;</span>), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb36-6"><a href="#cb36-6"></a>wq_trimmed &lt;-<span class="st"> </span>wq <span class="op">%&gt;%</span></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="st">    </span><span class="kw">select</span>(station_code, month, day, temp, sal, do_pct, depth) <span class="op">%&gt;%</span></span>
<span id="cb36-8"><a href="#cb36-8"></a><span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(depth)) <span class="op">%&gt;%</span></span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">depth_ft =</span> depth <span class="op">*</span><span class="st"> </span><span class="fl">3.28</span>,</span>
<span id="cb36-10"><a href="#cb36-10"></a>           <span class="dt">temp_f =</span> (<span class="dv">9</span><span class="op">/</span><span class="dv">5</span>) <span class="op">*</span><span class="st"> </span>temp <span class="op">+</span><span class="st"> </span><span class="dv">32</span>)</span></code></pre></div>
<div id="example-data" class="section level2">
<h2><span class="header-section-number">4.1</span> Example data</h2>
<p>tables 1, 2, 3, 4a, 4b, and 5 are all built-in datasets in R. They are different ways of representing the same data and are subsets from World Health Organization Tuberculosis data between 1999-2000.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>table1</span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a>table2</span></code></pre></div>
<p>Generate “toy data” to follow along with the slides</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>cases &lt;-<span class="st"> </span><span class="kw">tribble</span>(</span>
<span id="cb38-2"><a href="#cb38-2"></a>    <span class="op">~</span>Country, <span class="op">~</span><span class="st">&quot;2011&quot;</span>, <span class="op">~</span><span class="st">&quot;2012&quot;</span>, <span class="op">~</span><span class="st">&quot;2013&quot;</span>,</span>
<span id="cb38-3"><a href="#cb38-3"></a>    <span class="st">&quot;FR&quot;</span>,    <span class="dv">7000</span>,    <span class="dv">6900</span>,    <span class="dv">7000</span>,</span>
<span id="cb38-4"><a href="#cb38-4"></a>    <span class="st">&quot;DE&quot;</span>,    <span class="dv">5800</span>,    <span class="dv">6000</span>,    <span class="dv">6200</span>,</span>
<span id="cb38-5"><a href="#cb38-5"></a>    <span class="st">&quot;US&quot;</span>,   <span class="dv">15000</span>,   <span class="dv">14000</span>,   <span class="dv">13000</span></span>
<span id="cb38-6"><a href="#cb38-6"></a>)</span>
<span id="cb38-7"><a href="#cb38-7"></a></span>
<span id="cb38-8"><a href="#cb38-8"></a>pollution &lt;-<span class="st"> </span><span class="kw">tribble</span>(</span>
<span id="cb38-9"><a href="#cb38-9"></a>    <span class="op">~</span>city, <span class="op">~</span>size, <span class="op">~</span>amount,</span>
<span id="cb38-10"><a href="#cb38-10"></a>    <span class="st">&quot;New York&quot;</span>, <span class="st">&quot;large&quot;</span>,      <span class="dv">23</span>,</span>
<span id="cb38-11"><a href="#cb38-11"></a>    <span class="st">&quot;New York&quot;</span>, <span class="st">&quot;small&quot;</span>,      <span class="dv">14</span>,</span>
<span id="cb38-12"><a href="#cb38-12"></a>    <span class="st">&quot;London&quot;</span>, <span class="st">&quot;large&quot;</span>,      <span class="dv">22</span>,</span>
<span id="cb38-13"><a href="#cb38-13"></a>    <span class="st">&quot;London&quot;</span>, <span class="st">&quot;small&quot;</span>,      <span class="dv">16</span>,</span>
<span id="cb38-14"><a href="#cb38-14"></a>    <span class="st">&quot;Beijing&quot;</span>, <span class="st">&quot;large&quot;</span>,     <span class="dv">121</span>,</span>
<span id="cb38-15"><a href="#cb38-15"></a>    <span class="st">&quot;Beijing&quot;</span>, <span class="st">&quot;small&quot;</span>,     <span class="dv">121</span></span>
<span id="cb38-16"><a href="#cb38-16"></a>)</span></code></pre></div>
<div id="your-turn-7" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Your Turn 7</h3>
<p><em>not code</em> On a sheet of paper, draw how the cases data set would look if it had the same values grouped into three columns: country, year, n</p>
</div>
</div>
<div id="pivoting-data-from-wide-to-long-using-pivot_longer" class="section level2">
<h2><span class="header-section-number">4.2</span> Pivoting data from wide to long using <code>pivot_longer()</code></h2>
<p>Start with the data frame to reshape. Then, pipe <code>%&gt;%</code> to the <code>pivot_longer()</code> function, you’ll enter information in a series of arguments:</p>
<ul>
<li>cols: numeric indices of columns to collapse (or can be names)</li>
<li>names_to: name of the new key columns (a character string)</li>
<li>values_to: name of the new value column (a character string)</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># the column identifiers can be in a variety of ways:</span></span>
<span id="cb39-2"><a href="#cb39-2"></a></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="co"># using the numeric indices of the specific columns</span></span>
<span id="cb39-4"><a href="#cb39-4"></a>cases <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">names_to =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb39-6"><a href="#cb39-6"></a></span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="co"># using the column names</span></span>
<span id="cb39-8"><a href="#cb39-8"></a>cases <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-9"><a href="#cb39-9"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(<span class="st">&quot;2011&quot;</span>, <span class="st">&quot;2012&quot;</span>, <span class="st">&quot;2013&quot;</span>), <span class="dt">names_to =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb39-10"><a href="#cb39-10"></a></span>
<span id="cb39-11"><a href="#cb39-11"></a><span class="co"># or &quot;everything except...&quot;</span></span>
<span id="cb39-12"><a href="#cb39-12"></a>cases <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-13"><a href="#cb39-13"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="op">-</span>Country, <span class="dt">names_to =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb39-14"><a href="#cb39-14"></a></span>
<span id="cb39-15"><a href="#cb39-15"></a><span class="co"># or even helper functions like &#39;starts_with...&#39;</span></span>
<span id="cb39-16"><a href="#cb39-16"></a>cases <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-17"><a href="#cb39-17"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">starts_with</span>(<span class="st">&quot;201&quot;</span>), <span class="dt">names_to =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div id="your-turn-8" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Your Turn 8</h3>
<p>Use <code>pivot_longer()</code> to reorganize <code>table4a</code> into three columns: country, year, and cases.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>table4a <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">names_to =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="pivoting-data-from-long-to-wide-using-pivot_wider" class="section level2">
<h2><span class="header-section-number">4.3</span> Pivoting data from long to wide using <code>pivot_wider()</code></h2>
<p>Like the pivot_longer() function that you pipe to, pivot_wider() contains two main arguments:</p>
<ul>
<li>names_from: column to use for keys (becomes new variable column names)</li>
<li>values_from: column to use for values (becomes new column cells)</li>
</ul>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>pollution <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> size, <span class="dt">values_from =</span> amount)</span></code></pre></div>
<p><em>Notice that in <code>pivot_wider()</code>, you are pulling arguments out from variables in your data. Therefore, they do not have quotations around them in the code.</em></p>
<div id="your-turn-9" class="section level3">
<h3><span class="header-section-number">4.3.1</span> Your Turn 9</h3>
<p>Use pivot_wider() to reorganize table2 into four columns: country, year, cases, and population.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>table2 <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> type, <span class="dt">values_from =</span> count)</span></code></pre></div>
<hr />
<hr />
<hr />
</div>
</div>
</div>
<div id="extra-oyo" class="section level1">
<h1><span class="header-section-number">5</span> Extra OYO</h1>
<div id="dates-and-times" class="section level2">
<h2><span class="header-section-number">5.1</span> Dates and Times</h2>
<p>Because we’ve just worked a little bit with mutate, and one of the things you may find yourself doing is trying to get dates and times in the right format, this seems like a good time to tackle it. We will make up a vector of date-like things and learn how to use the <code>lubridate</code> package to deal with them.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>dates_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">dates01 =</span> <span class="kw">c</span>(<span class="st">&quot;1-1-2019&quot;</span>, <span class="st">&quot;1-2-2019&quot;</span>, <span class="st">&quot;1-3-2019&quot;</span>),</span>
<span id="cb43-2"><a href="#cb43-2"></a>                       <span class="dt">dates02 =</span> <span class="kw">c</span>(<span class="st">&quot;1/1/19&quot;</span>, <span class="st">&quot;1/2/19&quot;</span>, <span class="st">&quot;1/3/19&quot;</span>),</span>
<span id="cb43-3"><a href="#cb43-3"></a>                       <span class="dt">dates03 =</span> <span class="kw">c</span>(<span class="st">&quot;2019-01-01&quot;</span>, <span class="st">&quot;2019-01-02&quot;</span>, <span class="st">&quot;2019-01-03&quot;</span>),</span>
<span id="cb43-4"><a href="#cb43-4"></a>                       <span class="dt">datetime =</span> <span class="kw">c</span>(<span class="st">&quot;2019-01-01 12:00&quot;</span>, <span class="st">&quot;2019-01-01 13:00&quot;</span>, </span>
<span id="cb43-5"><a href="#cb43-5"></a>                                    <span class="st">&quot;2019-01-01 14:00&quot;</span>))</span></code></pre></div>
<p>How are these showing up in the data frame?</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">glimpse</span>(dates_df)</span></code></pre></div>
<p>If you try to make a time-series graph, it might work; but it will be very, very slow when you have more than 3 values. You also run the risk of dates being shuffled so they’re out of order. So we really want those dates to be <em>dates</em>.</p>
<p>This seems like it should be easy in base R, using the <code>as.Date()</code> function, but that can give you the wrong output (without so much as a warning!) if your date isn’t formatted the way the function thinks it should be:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>dates_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">dates01_changed =</span> <span class="kw">as.Date</span>(dates01),</span>
<span id="cb45-3"><a href="#cb45-3"></a>           <span class="dt">dates02_changed =</span> <span class="kw">as.Date</span>(dates02),</span>
<span id="cb45-4"><a href="#cb45-4"></a>           <span class="dt">dates03_changed =</span> <span class="kw">as.Date</span>(dates03))</span></code></pre></div>
<p>Enter the lubridate package. It lets you turn character strings and even numbers into dates - or date/times! - by specifying the order of what’s in your data as the function name.</p>
<p>That’s hard to explain, so let’s just do it. The first column is currently in “m-d-y” (with 4 digits in the year) format. The second is “m/d/y” - similar format, but only two digits in the year. The same lubridate function will work for both of these: <code>mdy()</code>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>dates_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-2"><a href="#cb46-2"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">dates01_changed =</span> <span class="kw">mdy</span>(dates01),</span>
<span id="cb46-3"><a href="#cb46-3"></a>           <span class="dt">dates02_changed =</span> <span class="kw">mdy</span>(dates02)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="st">    </span><span class="kw">glimpse</span>()  <span class="co"># to see the structure</span></span></code></pre></div>
<p>Notice the returned date is “yyyy-mm-dd”, which is actually a standard date format known as ISO 8601.</p>
<p>For our 3rd column, it’s already in that order we need, but we need it to be a date. Any guesses as to what that function is?</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>dates_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">dates01_changed =</span> <span class="kw">mdy</span>(dates01),</span>
<span id="cb47-3"><a href="#cb47-3"></a>           <span class="dt">dates02_changed =</span> <span class="kw">mdy</span>(dates02),</span>
<span id="cb47-4"><a href="#cb47-4"></a>           <span class="dt">dates03_changed =</span> <span class="op">---</span>(dates03)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb47-5"><a href="#cb47-5"></a><span class="st">    </span><span class="kw">glimpse</span>()</span></code></pre></div>
<p>Times make things trickier. R wants date-time columns to be in a format called <code>POSIX</code>. There is a function in base R called <code>as.POSIXct()</code> that lets you transform different values into that format. It is a burden though to specify the format you’re feeding into the function. (If you don’t want to take my word for it, look up the help file: <code>?as.POSIXct</code>)</p>
<p>The lubridate package makes it just as simple as the dates we did above. Again, the exact function you want to use depends on the order your date appears, but all you have to do is add <code>_hm</code> or <code>_hms</code> to the end of your <code>mdy</code>/<code>ymd</code> function, depending on whether your time has seconds or not.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>dates_df <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">dates01_changed =</span> <span class="kw">mdy</span>(dates01),</span>
<span id="cb48-3"><a href="#cb48-3"></a>           <span class="dt">dates02_changed =</span> <span class="kw">mdy</span>(dates02),</span>
<span id="cb48-4"><a href="#cb48-4"></a>           <span class="dt">dates03_changed =</span> <span class="kw">ymd</span>(dates03),</span>
<span id="cb48-5"><a href="#cb48-5"></a>           <span class="dt">datetime_changed =</span> <span class="kw">ymd_hm</span>(datetime)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-6"><a href="#cb48-6"></a><span class="st">    </span><span class="kw">glimpse</span>()</span></code></pre></div>
<p>If you only work with times in their own column, the <code>hms</code> library may help you out. There are differences between operating systems and software versions in how Excel stores dates and times in its brain, so <strong>be VERY CAREFUL</strong> and check your transformed data to make sure you have the output you think you have!</p>
<div id="your-turn---dates-and-times" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Your Turn - Dates and Times</h3>
<p><code>mutate</code> can be used to add a complete vector of the same value. That is what we’ll do below. Fill in the skeleton code to create a column for a full yyyy-mm-dd style date, then make a <em>line</em> graph of temperature throughout the year at the water quality stations, and color them by station code.</p>
<p>Which of these stations do you think is at the NERR in Alaska?</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>wq_trimmed <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="dv">2016</span>,</span>
<span id="cb49-3"><a href="#cb49-3"></a>           <span class="dt">date_pasted =</span> <span class="kw">paste</span>(year, month, day, <span class="dt">sep =</span> <span class="st">&quot;-&quot;</span>),</span>
<span id="cb49-4"><a href="#cb49-4"></a>           <span class="dt">date =</span> <span class="op">----</span>(date_pasted)) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># hint: use a lubridate function!</span></span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="st">    </span><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb49-6"><a href="#cb49-6"></a><span class="st">    </span>geom_<span class="op">----</span>(<span class="dt">mapping =</span> <span class="op">----</span>(<span class="dt">x =</span> date, <span class="dt">y =</span> temp_f, <span class="dt">col =</span> <span class="op">----</span>))</span></code></pre></div>
<hr />
<hr />
<hr />
</div>
</div>
</div>

<div id="rmd-source-code">LS0tDQp0aXRsZTogIlNlc3Npb24gMiAtIFdyYW5nbGUgRGF0YSINCm91dHB1dDoNCiAgaHRtbF9kb2N1bWVudDoNCiAgICB0b2M6IHRydWUNCiAgICB0b2NfZmxvYXQ6IHRydWUNCiAgICBudW1iZXJfc2VjdGlvbnM6IHRydWUNCiAgICBjb2RlX2Rvd25sb2FkOiB0cnVlDQogICAgdGhlbWU6IHlldGkNCiAgICBoaWdobGlnaHQ6IHRhbmdvDQogICAgZGZfcHJpbnQ6IHBhZ2VkDQotLS0NCg0KPGRpdiBjbGFzcz0icHJvZ3Jlc3MiPg0KICA8ZGl2IGNsYXNzPSJwcm9ncmVzcy1iYXIgcHJvZ3Jlc3MtYmFyLXN0cmlwZWQiIHJvbGU9InByb2dyZXNzYmFyIiBzdHlsZT0id2lkdGg6IDQyJSIgYXJpYS12YWx1ZW5vdz0iMTAiIGFyaWEtdmFsdWVtaW49IjAiIGFyaWEtdmFsdWVtYXg9IjEwMCI+PC9kaXY+DQo8L2Rpdj4NCg0KPHJpZ2h0PjxibG9ja3F1b3RlIGNsYXNzPSJibG9ja3F1b3RlIHRleHQtcmlnaHQiPg0KICA8cCBjbGFzcz0ibWItMCI+RGF0YSBjb21lcyBpbiBtYW55IGZvcm1hdHMsIGJ1dCBSIHByZWZlcnMganVzdCBvbmU6IHRpZHkgZGF0YS48L3A+DQogIDxmb290ZXIgY2xhc3M9ImJsb2NrcXVvdGUtZm9vdGVyIj5HYXJyZXQgR3JvbGVtdW5kLCA8Y2l0ZSB0aXRsZT0iU291cmNlIFRpdGxlIj5SU3R1ZGlvPC9jaXRlPjwvZm9vdGVyPg0KPC9ibG9ja3F1b3RlPjwvcmlnaHQ+DQoNCg0KYGBge3Igc2V0dXAsIGluY2x1ZGU9RkFMU0V9DQprbml0cjo6b3B0c19jaHVuayRzZXQoZWNobyA9IFRSVUUpIA0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KHJlc3VsdHMgPSAiaGlkZSIpDQprbml0cjo6b3B0c19jaHVuayRzZXQoZXZhbCA9IEZBTFNFKQ0KYGBgDQoNCmBgYHtyLCBtZXNzYWdlID0gRkFMU0UsIHdhcm5pbmcgPSBGQUxTRX0NCmxpYnJhcnkoZHBseXIpDQpsaWJyYXJ5KHRpZHlyKQ0KbGlicmFyeShsdWJyaWRhdGUpDQpsaWJyYXJ5KGhlcmUpDQpsaWJyYXJ5KGdncGxvdDIpDQpgYGANCg0KDQpTb21ldGltZXMsIHRoZSBkYXRhIHdlJ3JlIHdvcmtpbmcgd2l0aCBpcyBub3QgcXVpdGUgcmVhZHkgZm9yIHdoYXRldmVyIGl0IGlzIHdlIHdhbnQgdG8gZG8uIFdlIG1heSBuZWVkIHRvIHN1bW1hcml6ZSB0aGUgZGF0YSBiYXNlZCBvbiBzb21lIGdyb3VwLCBjYWxjdWxhdGUgYWRkaXRpb25hbCBwYXJhbWV0ZXJzLCBzdWJzZXQgdGhlIGRhdGEsIG9yIGV2ZW4gY29tcGxldGVseSByZXNoYXBlIGl0LiBUaGUgcGFja2FnZXMgYGRwbHlyYCBhbmQgYHRpZHlyYCBjYW4gaGVscCB3aXRoIHRoZXNlIHRhc2tzISAgDQoNCiMgZHBseXIgdmVyYnMgDQoNClRoZXJlIGFyZSB0aHJlZSBrZXkgZnVuY3Rpb25zIGluIGBkcGx5cmAgdGhhdCBhcmUgcmVhbGx5IHRoZSB3b3JraG9yc2VzIG9mIHRoZSB0aWR5dmVyc2U6ICANCg0KKyAgYGZpbHRlcigpYCB0byBzdWJzZXQgYmFzZWQgb24gcm93cw0KKyAgYHNlbGVjdCgpYCB0byBzdWJzZXQgYmFzZWQgb24gY29sdW1ucyAgDQorICBgbXV0YXRlKClgIHRvIGFkZCBvciBtb2RpZnkgdmFsdWVzIGluIGNvbHVtbnMgIA0KDQpXZSB3aWxsIHVzZSBkYXRhIGRvd25sb2FkZWQgZnJvbSBbZUJpcmRdKGh0dHBzOi8vZWJpcmQub3JnKSB0byBleHBsb3JlIHRoZXNlLiAqZUJpcmQgaXMgYSBsYXJnZSBjaXRpemVuLXNjaWVuY2UgZHJpdmVuIHByb2plY3QgdGhhdCBwcm92aWRlcyBhIGRhdGFiYXNlIG9mIGJpcmQgc2lnaHRpbmdzIGFyb3VuZCB0aGUgd29ybGQuIEl0IGlzIGNvbGxhYm9yYXRpdmUgYW5kIHRoZSBkYXRhIGlzIGZyZWVseSBhY2Nlc3NiaWxlIHRvIGFueW9uZS4qDQoNCkZpcnN0LCBsZXQncyByZWFkIGluIHRoZSBlQmlyZCBkYXRhIGFuZCBleHBsb3JlIGl0OiAgDQoNCmBgYHtyLCByZXN1bHRzID0gJ2hpZGUnfQ0KZWJpcmQgPC0gcmVhZC5jc3YoaGVyZTo6aGVyZSgiZGF0YSIsICJlQmlyZF93b3Jrc2hvcC5jc3YiKSwgc3RyaW5nc0FzRmFjdG9ycyA9IEZBTFNFKQ0KZHBseXI6OmdsaW1wc2UoZWJpcmQpICAgIyAxODMsNzQyIHJvd3MNCmBgYA0KDQpXZSBtYXkgbm90IHRhbGsgYWJvdXQgdGhpcyBpbiB0aGUgd29ya3Nob3AsIGJ1dCB0aGVyZSBhcmUgKHByZXN1bWFibHkgYWNjaWRlbnRhbGx5KSBkdXBsaWNhdGUgcm93cyBpbiB0aGlzIGRhdGEgZnJhbWUuIFdlIGNhbiBzZWUgdGhlbSB3aXRoOiAgDQoNCmBgYHtyLCByZXN1bHRzID0gImhpZGUifQ0KamFuaXRvcjo6Z2V0X2R1cGVzKGViaXJkKSAgICMgMjIgZHVwbGljYXRlcyA9IDExIHRoYXQgbmVlZCB0byBnbw0KYGBgDQoNClRoZXkgYXJlIGV4YWN0IGNvcGllcyBvZiBvdGhlciByb3dzLCBub3QgYW55IGRhdGEgZW50cnkgcHJvYmxlbXMgKGFsdGhvdWdoIGBqYW5pdG9yOjpnZXRfZHVwZXMoKWAgaXMgdmVyeSBoZWxwZnVsIGluIGZpbmRpbmcgZXJyb3JzIGxpa2UgbWlzLXR5cGluZyBhIHNpdGUgbmFtZSksIHNvIHdlJ2xsIGp1c3QgZ2V0IHJpZCBvZiB0aGVtIGJ5IHVzaW5nIGBkcGx5cjo6ZGlzdGluY3QoKWAgdG8ga2VlcCBvbmx5IHVuaXF1ZSByb3dzLiAgDQoNCmBgYHtyfQ0KZWJpcmQgPC0gZHBseXI6OmRpc3RpbmN0KGViaXJkKQ0KZHBseXI6OmdsaW1wc2UoZWJpcmQpICAgIyAxODMsNzMxIHJvd3MNCmBgYA0KDQoNCiMjIENob29zZSBfcm93c186IGBmaWx0ZXIoKWAgIA0KDQpUaGlzIGRhdGEgc2V0IGhhcyBhIGxvdCBvZiByb3dzLiBXZSBtaWdodCBvbmx5IGJlIGludGVyZXN0ZWQgaW4gb2JzZXJ2YXRpb25zIGFib3V0IGEgc2luZ2xlIGJpcmQgc3BlY2llcywgb3IgZnJvbSBhIHNpbmdsZSBzdGF0ZSwgd2hpY2ggbWVhbnMgd2Ugd2FudCB0byBjaG9vc2UgKnJvd3MqLiBUbyBkbyB0aGlzLCB3ZSB1c2UgdGhlIHZlcmIgYGZpbHRlcigpYC4gVGhlIGRhdGEgYXJndW1lbnQgY29tZXMgZmlyc3QsIHRoZW4gdGhlIGNvbmRpdGlvbi4gICAgDQoNCmBgYHtyfQ0KZmlsdGVyKGViaXJkLCBzdGF0ZSA9PSAiQUsiKQ0KYGBgDQoNCkFsdGVybmF0ZWx5LCB3ZSBjYW4gdXNlIHRoZSBwaXBlLCB3aGljaCBmZWVkcyB0aGUgZGF0YSBmcmFtZSByZXN1bHRpbmcgZnJvbSBldmVyeXRoaW5nIGJlZm9yZSBpdCBpbnRvIHdoYXRldmVyIGlzIG5leHQgKHJlYWQgaXQgYXMgImFuZCB0aGVuLi4uLiIpICANCldlIGNhbiBhbHNvIHBpcGUgdG8gZ2xpbXBzZSB0byBleHBsb3JlIGl0IGEgbGl0dGxlIG1vcmUuDQoNCmBgYHtyfQ0KZWJpcmQgJT4lIA0KICAgIGZpbHRlcihzdGF0ZSA9PSAiQUsiKSAlPiUgDQogIGRwbHlyOjpnbGltcHNlKCkNCmBgYA0KDQpOb3RpY2UgYSBjb3VwbGUgdGhpbmdzIGhlcmU6ICANCg0KKyAgV2UgdXNlIGA9PWAgdG8gc3BlY2lmeSBhbiBleGFjdCBjb25kaXRpb24uIElmIHdlIHdlcmUgd29ya2luZyB3aXRoIG51bWJlcnMsIHdlIGNvdWxkIHVzZTogIA0KICAgICsgIGA8YCAgDQogICAgKyAgYDw9YCAgDQogICAgKyAgYD09YCAgDQogICAgKyAgYCE9YCAoKipub3QqKiBlcXVhbCB0bykgIA0KICAgICsgIGA+PWAgIA0KICAgICsgIGA+YCAgDQorICBUaGUgY29uZGl0aW9uIHNwZWNpZmllZCBpbnNpZGUgYGZpbHRlcigpYCBNVVNUIHJldHVybiBlaXRoZXIgdHJ1ZSBvciBmYWxzZSwgZm9yIGVhY2ggcm93LiAgDQoNCg0KKipIb3cgYWJvdXQgZm9yIG11bHRpcGxlIGNvbmRpdGlvbnM/KiogIA0KDQpXZSBjYW4gZmlsdGVyIGJhc2VkIG9uIG1vcmUgdGhhbiBvbmUgY3JpdGVyaW9uLCBlLmcuIGlmIHdlIHdhbnQgYWxsIGJpcmRzIGZyb20gQWxhc2thLCBidXQgb25seSBpbiB0aGUgeWVhciAyMDA4OiAgDQoNCmBgYHtyfQ0KZWJpcmQgJT4lIA0KICAgIGZpbHRlcihzdGF0ZSA9PSAiQUsiLA0KICAgICAgICAgICB5ZWFyID09IDIwMDgpICU+JSANCmhlYWQoKQ0KYGBgDQoNCg0KKipOb3RlKio6IEl0IGRvZXNuJ3QgbWF0dGVyIGlmIHlvdSBzZWxlY3QgYHN0YXRlYCBvciBgeWVhcmAgZmlyc3QgLSB5b3UgY2FuIGRvIGVpdGhlci4gIA0KDQoqKk5vdGUqKjogaWYgeW91IGFjdHVhbGx5IG5lZWQgdG8gd29yayB3aXRoIHRoZSBkYXRhIGZyYW1lIGxhdGVyLCB5b3UgbWF5IGNvbnNpZGVyIHNhdmluZyB0aGVzZSBzdGVwcyBhcyBuZXcgZGF0YSBmcmFtZXMhICANCg0KKipXaGF0IGlmIHdlIHdhbnQgdG8gbG9vayBhdCBiaXJkcyBmcm9tIG1vcmUgdGhhbiBvbmUgc3RhdGU/KioNCg0KVGhlcmUgYXJlIGEgZmV3IHdheXMgdG8gZG8gdGhpcy4gDQoNClBlcmhhcHMgdGhlIGVhc2llc3QgaXMgdG8gbWFrZSBhIHZlY3RvciBvZiB0aGUgc3RhdGVzIHlvdSdyZSBpbnRlcmVzdGVkIGluOiAgDQoNCmBgYHtyfQ0KbXlfc3RhdGVzIDwtIGMoIkFLIiwgIkFMIiwgIk1TIikNCmBgYA0KDQpBbmQgdGhlbiB1c2UgYCVpbiVgIGluIHRoZSBmaWx0ZXIgc3RhdGVtZW50LCB0byBzYXksIGUuZy4gImFueSBvZiB0aGUgc3RhdGVzIF9pbl8gdGhpcyB2ZWN0b3IiOiANCg0KYGBge3J9DQplYmlyZF9teXN0YXRlcyA8LSBlYmlyZCAlPiUgDQogICAgZmlsdGVyKHllYXIgPT0gMjAwOCwNCiAgICAgICAgICAgc3RhdGUgJWluJSBteV9zdGF0ZXMpIA0KaGVhZChlYmlyZF9teXN0YXRlcykNCg0KIyBtYWtlIHN1cmUgdGhlIHN0YXRlcyB3ZSBuYW1lZCwgYW5kIG9ubHkgdGhlIHN0YXRlcyB3ZSBuYW1lZCwgYXJlIHJlcHJlc2VudGVkOg0KdW5pcXVlKGViaXJkX215c3RhdGVzJHN0YXRlKQ0KYGBgDQoNCllvdSBjb3VsZCBhbHNvIHNraXAgdGhlIHN0ZXAgb2YgbmFtaW5nIHRoZSB2ZWN0b3Igc2VwYXJhdGVseTogIA0KDQpgYGB7cn0NCmViaXJkICU+JSANCiAgICBmaWx0ZXIoeWVhciA9PSAyMDA4LA0KICAgICAgICAgICBzdGF0ZSAlaW4lIGMoIkFLIiwgIkFMIiwgIk1TIikpICU+JSANCiAgICBoZWFkKCkNCmBgYA0KDQoNCiMjIyBZb3VyIFR1cm4gMSAgDQoNCkhvdyBjb3VsZCB3ZSBwdWxsIG91dCBiaXJkcyBpbiBBbGFza2EgKEFLKSwgYmVmb3JlIDIwMTA/IChIaW50OiB5b3UgY2FuIHVzZSB0aGUgc2FtZSBzeW1ib2xzIG9uIHllYXIgdGhhdCB5b3Ugd291bGQgdXNlIHdpdGggYW55IG90aGVyIG51bWJlcnMpICANCg0KYGBge3J9DQplYmlyZCAlPiUgDQogIGRwbHlyOjpmaWx0ZXIoc3RhdGUgPT0gIkFLIiwNCiAgICAgICAgICAgICAgICB5ZWFyIDwgMjAxMCkNCmBgYA0KDQoNCkhvdyB3b3VsZCB5b3UgZmlsdGVyIHRoZSBkYXRhIHRvIGNvbnRhaW4gb25seSB0aGUgc3BlY2llcyAiQW1lcmljYW4gQ29vdCIgZnJvbSBNUyBhbmQgRkwgKHlvdXIgaW5zdHJ1Y3RvcnMnIHN0YXRlcyksIGluIGFsbCB5ZWFycyAqZXhjZXB0KiAyMDEwPyBBc3NpZ24gdGhpcyBvYmplY3QgdG8gYSBkYXRhIGZyYW1lIGFuZCB2ZXJpZnkgKHVzaW5nIGB1bmlxdWUoKWApIHRoYXQgeW91IGRpZCBpdCByaWdodC4gICAgDQoNCmBgYHtyfQ0KeXQxIDwtIGViaXJkICU+JSANCiAgZHBseXI6OmZpbHRlcihzcGVjaWVzID09ICJBbWVyaWNhbiBDb290IiwNCiAgICAgICAgICAgICAgICBzdGF0ZSAlaW4lIGMoIk1TIiwgIkZMIiksDQogICAgICAgICAgICAgICAgeWVhciAhPSAyMDEwKQ0KDQp1bmlxdWUoeXQxJHNwZWNpZXMpDQp1bmlxdWUoeXQxJHN0YXRlKQ0KdW5pcXVlKHl0MSR5ZWFyKQ0KYGBgDQoNCioqKg0KDQojIyBDaG9vc2UgX2NvbHVtbnNfOiBgc2VsZWN0KClgICANCg0KV2hlbiB5b3UncmUgd29ya2luZyB3aXRoIGEgbG90IG9mIGRhdGEsIHlvdSBtYXkgbm90IHdhbnQgb3IgbmVlZCB0byBrZWVwIGFsbCB0aGUgY29sdW1ucyB5b3Ugc3RhcnRlZCB3aXRoLiBJbiB0aGlzIGNhc2UsIGBzZWxlY3QoKWAgaXMgd2hhdCB5b3UgbmVlZC4NCg0KVGhlIGViaXJkIGRhdGEgZnJhbWUgZG9lc24ndCBoYXZlIHRvbyBtYW55IGNvbHVtbnMsIGJ1dCB0aGF0IG1ha2VzIGl0IGVhc3kgdG8gc2VlIGV4YWN0bHkgd2hhdCB3ZSdyZSBkb2luZyEgTGV0J3MgcHJldGVuZCB3ZSBvbmx5IHdhbnQgdG8ga2VlcCBzcGVjaWVzLCBzdGF0ZSwgYW5kIHllYXIuIFdlIGNhbiBkbyB0aGlzIHR3byB3YXlzOiAgDQoNCkZpcnN0LCBieSBzZWxlY3RpbmcgdGhlIGNvbHVtbnMgd2UgKipkbyoqIHdhbnQgdG8ga2VlcDogIA0KDQpgYGB7cn0NCmViaXJkICU+JSANCiAgICBzZWxlY3Qoc3BlY2llcywgc3RhdGUsIHllYXIpICU+JSANCiAgICBoZWFkKCkNCmBgYA0KDQoNCk9yIHNlY29uZCwgYnkgdXNpbmcgYSBgLWAgaW4gZnJvbnQgb2YgdGhlIGNvbHVtbnMgd2UgKipkb24ndCoqIHdhbnQgdG8ga2VlcDogIA0KDQpgYGB7cn0NCmViaXJkICU+JSANCiAgICBzZWxlY3QoLXNhbXBsZXNpemUsIC1wcmVzZW5jZSkgJT4lIA0KICAgIGhlYWQoKQ0KYGBgDQoNCkVpdGhlciBvZiB0aGVzZSBjYW4gYmUgcmVhbGx5IGhhbmR5IGRlcGVuZGluZyBvbiB3aGF0IHlvdXIgb3JpZ2luYWwgZGF0YSBmcmFtZSBsb29rcyBsaWtlIGFuZCB3aGF0IHlvdSdyZSB0cnlpbmcgdG8gZG8hICANCg0KDQpPcmRlciAqKmRvZXMqKiBtYXR0ZXIgaW4gYHNlbGVjdCgpYDsgcmVtZW1iZXIgaXQgZGlkbid0IG1hdHRlciBpbiBgZmlsdGVyKClgLiBJbiBgc2VsZWN0KClgLCBzZWxlY3Rpb25zIGFyZSBtYWRlIGluIHRoZSBvcmRlciBzcGVjaWZpZWQgLSBzbyBpZiB5b3Ugd2FudCB0byByZWFycmFuZ2UgdGhlIGNvbHVtbnMgb2YgeW91ciBkYXRhLCB5b3UgY2FuIGRvIGl0IHdpdGggdGhpcyBjb21tYW5kISAgDQoNCmBgYHtyfQ0KZWJpcmQgJT4lIA0KICAgIHNlbGVjdCh5ZWFyLCBzdGF0ZSwgc3BlY2llcykgJT4lIA0KICAgIGhlYWQoKQ0KYGBgDQoNCg0KWW91IGNhbiBhbHNvIG1vdmUganVzdCBvbmUgb3IgYSBmZXcgY29sdW1ucyB0byB0aGUgYmVnaW5uaW5nIGJ5IHNwZWNpZnlpbmcgaXQvdGhlbSwgYW5kIHRoZW4gYGV2ZXJ5dGhpbmcoKWAgLSBpdCBrZWVwcyBhbGwgb3RoZXIgY29sdW1ucywgaW4gdGhlaXIgb3JpZ2luYWwgb3JkZXI6ICANCg0KYGBge3J9DQplYmlyZCAlPiUgDQogICAgc2VsZWN0KHllYXIsIGV2ZXJ5dGhpbmcoKSkgJT4lIA0KICAgIGdsaW1wc2UoKQ0KYGBgDQoNCg0KIyMjIEFzaWRlIC0gaGVscGVyIGZ1bmN0aW9ucyAgDQoNClNvbWV0aW1lcyB5b3UgaGF2ZSBhIGxvdCBvZiBjb2x1bW5zIHRoYXQgc3RhcnQgd2l0aCB0aGUgc2FtZSBwcmVmaXgsIG9yIHRoYXQgZW5kIHdpdGggdGhlIHNhbWUgYXBwZW5kZWQgbWF0dGVyOyBtYXliZSB5b3Ugd2FudCB0byBrZWVwIGFsbCBvZiB0aGVtIChvciBnZXQgcmlkIG9mIGFsbCBvZiB0aGVtKS4gSW4gdGhlc2Ugc2l0dWF0aW9ucywgeW91IGNhbiB1c2UgdGhlIGhlbHBlciBmdW5jdGlvbnMgYHN0YXJ0c193aXRoKClgIGFuZCBgZW5kc193aXRoKClgLiBTZWUgdGhlIGBkcGx5cmAgY2hlYXRzaGVldCBmb3Igb3RoZXIgcG9zc2libGUgaGVscGVyIGZ1bmN0aW9ucy4gIA0KDQpJbiBvdXIgbGl0dGxlIGV4YW1wbGUsIGxldCdzIGtlZXAgY29sdW1ucyB3aG9zZSBuYW1lcyBzdGFydCB3aXRoICdzJzogIA0KDQpgYGB7cn0NCmViaXJkICU+JSANCiAgICBzZWxlY3Qoc3RhcnRzX3dpdGgoInMiKSkgJT4lIA0KICAgIGdsaW1wc2UoKQ0KYGBgDQoNCk9yIGNvbHVtbnMgdGhhdCBlbmQgd2l0aCAnZSc6ICANCg0KYGBge3J9DQplYmlyZCAlPiUgDQogICAgc2VsZWN0KGVuZHNfd2l0aCgiZSIpKSAlPiUgDQogICAgZ2xpbXBzZSgpDQpgYGANCg0KKkNoZWNrIG91dCB0aGUgZGF0YSB3cmFuZ2xpbmcgY2hlYXQgc2hlZXQgZm9yIG1vcmUgaGVscGVyIGZ1bmN0aW9ucy4qDQoNCiMjIyBZb3VyIFR1cm4gMiAgDQoNCkZyb20gdGhlIGViaXJkIGRhdGEsIHN1YnNldCB0byBvbmx5IGluY2x1ZGUgdGhlIHNwZWNpZXMgQW1lcmljYW4gQ29vdCwgZnJvbSB0aGUgc3RhdGVzIEZMLCBBTCwgYW5kIE1TLiBLZWVwIG9ubHkgdGhlIHN0YXRlLCB5ZWFyLCBhbmQgcHJlc2VuY2UgY29sdW1ucy4gV2hhdCBpcyB0aGUgcHJvcGVyIG9yZGVyIG9mIG9wZXJhdGlvbnMgaW4gdGhpcyBjYXNlPyAgDQoNCmBgYHtyfQ0KZWJpcmQgJT4lIA0KICBkcGx5cjo6ZmlsdGVyKHNwZWNpZXMgPT0gIkFtZXJpY2FuIENvb3QiLA0KICAgICAgICAgICAgICAgIHN0YXRlICVpbiUgYygiRkwiLCAiQUwiLCAiTVMiKSkgJT4lIA0KICBkcGx5cjo6c2VsZWN0KHN0YXRlLCB5ZWFyLCBwcmVzZW5jZSkgDQoNCiMgc2VsZWN0IHNlY29uZCBiZWNhdXNlIHlvdSBuZWVkIHNwZWNpZXMgYW5kIHN0YXRlIGluIG9yZGVyIHRvIGZpbHRlciENCmBgYA0KDQoNCioqKiAgDQoNCipTZXR1cCBmb3IgdGhlIG5leHQgYml0IG9mIHRoZSB3b3Jrc2hvcCogIA0KDQpXZSdyZSBnb2luZyB0byBzd2l0Y2ggZGF0YXNldHMgaGVyZSwgdG8gb25lIHRoYXQncyBhIGxpdHRsZSBtb3JlIGNvbXBsaWNhdGVkOiB3YXRlciBxdWFsaXR5IGRhdGEhIFdlIGRvd25sb2FkZWQgbW9uaXRvcmluZyBkYXRhIGZyb20gc2V2ZXJhbCBOYXRpb25hbCBFc3R1YXJpbmUgUmVzZWFyY2ggUmVzZXJ2ZXMgZm9yIHRoZSB5ZWFyIDIwMTYsIGFuZCBoYXZlIGFscmVhZHkgd2lubm93ZWQgaXQgZG93biBhIGJpdCB0byBkYWlseSBhdmVyYWdlcyBvZiBzZXZlcmFsIHBhcmFtZXRlcnMgdGhhdCB3ZSBtZWFzdXJlLiANCg0KV2Ugd2lsbCB1c2UgeW91ciBuZXdmb3VuZCBgc2VsZWN0KClgIGFuZCBgZmlsdGVyKClgIHNraWxscyB0byBtYWtlIGl0IGFuIGV2ZW4gc21hbGxlciBkYXRhIGZyYW1lLCBhbmQgdGhlbiB3ZSdsbCBsZWFybiBob3cgdG8gY2FsY3VsYXRlIG5ldyBjb2x1bW5zIGFuZCBkbyBncm91cC13aXNlIHN1bW1hcmllcy4gDQoNCmBgYHtyfQ0Kd3EgPC0gcmVhZC5jc3YoaGVyZTo6aGVyZSgiZGF0YSIsICJkYWlseV93cS5jc3YiKSwgc3RyaW5nc0FzRmFjdG9ycyA9IEZBTFNFKQ0KZ2xpbXBzZSh3cSkNCmBgYA0KDQoqKioNCg0KIyMjIFlvdXIgVHVybiAzICANCg0KQmVjYXVzZSB0aGlzIGlzIHNvIGltcG9ydGFudCwgSSB3aWxsIHByb3ZpZGUgd29ya2luZyBjb2RlIGluIGEgY2h1bmsgYmVsb3cuIEJ1dCBwbGVhc2UgYXR0ZW1wdCBpdCB5b3Vyc2VsZiBmaXJzdCEhISAgDQoNCldlIGhhdmUgcmVhZCBpbiB0aGUgZGFpbHkgd2F0ZXIgcXVhbGl0eSBkYXRhIGZvciBhIGZldyBzdGF0aW9ucy4gQ3JlYXRlIGEgbmV3IGRhdGEgZnJhbWUgY2FsbGVkIGB3cV90cmltbWVkYCB3aGVyZSwgZnJvbSBgd3FgLCB5b3U6ICAgIA0KDQorICAqKlNlbGVjdCoqIHRoZSBmb2xsb3dpbmcgY29sdW1uczogIHN0YXRpb25fY29kZSwgbW9udGgsIGRheSwgdGVtcCwgc2FsLCBkb19wY3QsIGFuZCBkZXB0aC4gIA0KKyAgKipGaWx0ZXIqKiBmb3Igcm93cyB3aGVyZSBgZGVwdGhgIGlzICpub3QqIG1pc3NpbmcuIChIaW50OiBgaXMubmFgIGlzIHRoZSBmdW5jdGlvbiB0aGF0IGNoZWNrcyB0byBzZWUgaWYgYSB2YWx1ZSAqaXMqIG1pc3NpbmcuIEhvdyB3b3VsZCB5b3UgbG9vayBmb3IgIm5vdCIgYGlzLm5hYD8gICBJdCdzIHNpbWlsYXIgdG8gIm5vdCBlcXVhbCB0byIgZnJvbSBhYm92ZS4pDQoNCmBgYHtyfQ0KDQpgYGANCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCiMjIyBZb3VyIFR1cm4gMyBhbnN3ZXIgICANCg0KTGFzdCBjaGFuY2UgdG8gdHJ5IGl0IHlvdXJzZWxmLi4uLiANCmJ1dCBpZiB5b3UgZGlkbid0IGdldCBpdCB0byB3b3JrLCBydW4gdGhpcyBjaHVuazogIA0KDQpgYGB7cn0NCndxX3RyaW1tZWQgPC0gd3EgJT4lIA0KICAgIHNlbGVjdChzdGF0aW9uX2NvZGUsIG1vbnRoLCBkYXksIHRlbXAsIHNhbCwgZG9fcGN0LCBkZXB0aCkgJT4lIA0KICAgIGZpbHRlcighaXMubmEoZGVwdGgpKQ0KYGBgDQoNCg0KDQoNCkhvdyBtdWNoIGhhcyBiZWVuIHJlbW92ZWQgZnJvbSB0aGUgZGF0YSBmcmFtZT8gIA0KDQpgYGB7cn0NCmRpbSh3cSkNCmRpbSh3cV90cmltbWVkKQ0KDQojIGNhbiBzdWJ0cmFjdCBib3RoIHJvd3MgYW5kIGNvbHVtbnMgYXQgb25jZSENCmRpbSh3cSkgLSBkaW0od3FfdHJpbW1lZCkNCg0KIyB3aHkgZGlkIGFsbCB0aG9zZSByb3dzIGdvIGF3YXk/DQpgYGANCg0KDQpTb21lIFNXTVAgc3RhdGlvbnMgcmVwb3J0IGBkZXB0aGAsIHdoaWNoIGlzIHdhdGVyIGRlcHRoIGFib3ZlIHRoZSBkYXRhIGxvZ2dlcjsgYW5kIG90aGVycyByZXBvcnQgYGxldmVsYCwgd2hpY2ggaXMgd2F0ZXIgc3VyZmFjZSByZWxhdGl2ZSB0byBhIHN0YW5kYXJkIGRhdHVtIChOQVZEODgpLiBUaGVyZSBpcyBhbiBpbXBvcnRhbnQgZGlzdGluY3Rpb24gdGhhdCdzIGlycmVsZXZhbnQgZm9yIHdoYXQgd2Ugd2FudCB0byBjb3ZlciB0b2RheSwgc28gaGVyZSB3ZSBoYXZlIG9ubHkga2VwdCB0aGUgc3RhdGlvbnMgdGhhdCByZXBvcnQgYGRlcHRoYC4gIA0KDQoNCg0KIyMgTW9kaWZ5aW5nIGRhdGEgZnJhbWVzIHdpdGggYG11dGF0ZSgpYCAgDQoNCg0KSXQncyBlYXN5IHRvIG1ha2UgYSBuZXcgdmFyaWFibGUgb3V0IG9mIG90aGVyIHZhcmlhYmxlcyBpbiB0aGUgZGF0YSBmcmFtZSB1c2luZyBgbXV0YXRlKClgLiBUaGlzIG9wZXJhdGVzIG9uIHJvd3MuIFNheSB3ZSB3YW50IHRvIHRhbGsgYWJvdXQgd2F0ZXIgZGVwdGggKG9yIG1ha2UgYSBncmFwaCEpIHRvIHRoZSBwdWJsaWMgLSB3ZSBtaWdodCB3YW50IHRvIGNoYW5nZSB0aGUgdW5pdHMgZnJvbSBtZXRlcnMgdG8gZmVldC4gVGhhdCdzIHNpbXBsZSBtdWx0aXBsaWNhdGlvbiEgU28gaGVyZSwgd2UnbGwgYWRkIGEgY29sdW1uIHRvIHRoZSBkYXRhIGZyYW1lLiAgICAgIA0KDQpgYGB7cn0NCndxX3RyaW1tZWQgJT4lIA0KICAgIG11dGF0ZShkZXB0aF9mdCA9IGRlcHRoICogMy4yOCkgJT4lDQogIGhlYWQoKQ0KDQpgYGANCg0KDQpZb3UgY2FuIGFsc28gdXNlIG90aGVyIGNvbHVtbnMuIFlvdSBjYW4gdXNlIHRoZW0gaW4gbWF0aGVtYXRpY2FsIGV4cHJlc3Npb25zLCBvciBqdXN0IGNvbWJpbmUgdGhlbTogICAgICAgIA0KDQpgYGB7cn0NCndxX3RyaW1tZWQgJT4lIA0KICAgIG11dGF0ZShtb250aGRheSA9IHBhc3RlKG1vbnRoLCBkYXksIHNlcCA9ICItIiksICAjIHNlZSA/cGFzdGUgZm9yIG1vcmUgaW5mbw0KICAgICAgICAgICBtZWFuaW5nbGVzc190aGluZyA9IHNhbCArIHRlbXApICU+JSANCiAgICBoZWFkKCkNCmBgYA0KDQoNCllvdSBjYW4gZXZlbiB1c2UgYSBjb2x1bW4gaW1tZWRpYXRlbHkgYWZ0ZXIgY3JlYXRpbmcgaXQhICANCg0KYGBge3J9DQp3cV90cmltbWVkIDwtIHdxX3RyaW1tZWQgJT4lIA0KICAgIG11dGF0ZShtb250aGRheSA9IHBhc3RlKG1vbnRoLCBkYXksIHNlcCA9ICItIiksDQogICAgICAgICAgIG1lYW5pbmdsZXNzX3RoaW5nID0gc2FsICsgdGVtcCwNCiAgICAgICAgICAgZXZlbl9tb3JlX21lYW5pbmdsZXNzX3RoaW5nID0gbWVhbmluZ2xlc3NfdGhpbmcgKyA1KSANCg0KYGBgDQoNCg0KDQoNCiMjIyBZb3VyIFR1cm4gNCAgDQoNClRoZXJlIGFyZSB0d28gcGFydHMgdG8gdGhpcy4gWW91IGNhbiBhcHByb2FjaCB0aGVtIHNlcGFyYXRlbHkgb3Igd2l0aGluIHRoZSBzYW1lIHNlcmllcyBvZiBwaXBlcy4gUmVtZW1iZXIgdG8gc2F2ZSB0aGUgcmVzdWx0IGFzIHRoZSBuZXcsIGJldHRlciwgYHdxX3RyaW1tZWRgIGRhdGEgZnJhbWUhICAgDQoNCjEuICBOb3cgdGhhdCB3ZSd2ZSBzdGFydGVkIGNyZWF0aW5nIG1vcmUgY29sdW1ucywgaXQgbWlnaHQgbWFrZSBzZW5zZSB0byBnZXQgcmlkIG9mIHNvbWUgb2xkIG9uZXMuIFJlbW92ZSBgbW9udGhkYXlgIGFuZCBgbWVhbmluZ2xlc3NfdGhpbmdgIGZyb20gdGhlIGB3cV90cmltbWVkYCBkYXRhIGZyYW1lLiAgDQoyLiAgVGhlIHNhbWUgcGVyc29uIHRoYXQgd2FudHMgdG8gc2VlIGBkZXB0aGAgaW4gZmVldCByYXRoZXIgdGhhbiBtZXRlcnMgKmFsc28qIHdhbnRzIHlvdSB0byB0dXJuIGB0ZW1wYCBpbnRvIEZhaHJlbmhlaXQsIGZyb20gQ2Vsc2l1cy4gWW91J3ZlIGxvb2tlZCB1cCB0aGUgY29udmVyc2lvbi4gTm93IGNyZWF0ZSBhIG5ldyBjb2x1bW4sIGB0ZW1wX2ZgLCB3aXRoIHRoZSBuZXcgdmFyaWFibGUuICAgKipGID0gKDkvNSkodGVtcCBpbiBDKSArIDMyKioNCg0KDQpBcyB3aXRoIFlvdXIgVHVybiA0LCB0aGUgYW5zd2VyIGlzIGJlbG93LiBObyBwZWVraW5nISAgDQoNCg0KYGBge3J9DQoNCmBgYA0KDQoNCg0KDQoNCg0KDQoNCg0KDQojIyMgWW91ciBUdXJuIDQgYW5zd2VyICANCg0KYGBge3J9DQp3cV90cmltbWVkIDwtIHdxX3RyaW1tZWQgJT4lIA0KICAgIHNlbGVjdCgtbW9udGhkYXksIC1tZWFuaW5nbGVzc190aGluZykgJT4lIA0KICAgIG11dGF0ZSh0ZW1wX2YgPSAoOS81KSAqIHRlbXAgKyAzMikNClZpZXcod3FfdHJpbW1lZCkNCmBgYA0KDQoNCg0KDQoNCiMgR3JvdXAtd2lzZSBvcGVyYXRpb25zIHdpdGggYGdyb3VwX2J5KClgIGFuZCBgc3VtbWFyaXplKClgICANCg0KU2F5IHdlIHdhbnQgdG8gZmluZCBvdXQgaG93IG1hbnkgYmlyZHMgd2VyZSBzZWVuIGJ5IHN0YXRlIGluIHRoZSBlYmlyZCBkYXRhc2V0LiBXZSBjYW4gZG8gdGhhdC4gVGhlc2Ugb3BlcmF0aW9ucyBhcmUgYWxzbyBncmVhdCBmb3IgbHVtcGluZyBkYXRhIGludG8gZGFpbHksIG1vbnRobHksIG9yIHllYXJseSBhdmVyYWdlcywgd2hpY2ggd2UnbGwgZG8gb24gdGhlIFNXTVAgZGF0YXNldC4gICAgDQoNCmBgYHtyfQ0KZWJpcmQgJT4lIA0KICAgIGdyb3VwX2J5KHN0YXRlKSAlPiUgDQogICAgc3VtbWFyaXplKG1lYW5fcHJlc2VuY2UgPSBtZWFuKHByZXNlbmNlLCBuYS5ybSA9IFRSVUUpLA0KICAgICAgICAgICAgICBtYXhfcHJlc2VuY2UgPSBtYXgocHJlc2VuY2UsIG5hLnJtID0gVFJVRSkpICU+JSANCiAgICBWaWV3KCkNCmBgYA0KDQoNCg0KV2UgY2FuIGFsc28gZ3JvdXAgYnkgY29tYmluYXRpb25zIG9mIG11bHRpcGxlIHZhcmlhYmxlczogIA0KDQpgYGB7cn0NCmViaXJkICU+JSANCiAgICBncm91cF9ieShzdGF0ZSwgc3BlY2llcykgJT4lIA0KICAgIHN1bW1hcml6ZShtZWFuX3ByZXNlbmNlID0gbWVhbihwcmVzZW5jZSwgbmEucm0gPSBUUlVFKSwNCiAgICAgICAgICAgICAgbWF4X3ByZXNlbmNlID0gbWF4KHByZXNlbmNlLCBuYS5ybSA9IFRSVUUpKSAlPiUgDQogICAgVmlldygpDQpgYGANCg0KDQoNCiMjIyBZb3VyIFR1cm4gNSAgDQoNCkhvdyB3b3VsZCB5b3UgZ3JvdXAgdGhlIGB3cV90cmltbWVkYCBkYXRhc2V0IHRvIGNhbGN1bGF0ZSBtb250aGx5IGF2ZXJhZ2UgdGVtcGVyYXR1cmUgYW5kIHNhbGluaXR5LCBhbmQgdGhlaXIgc3RhbmRhcmQgZGV2aWF0aW9ucywgYXQgZWFjaCBzdGF0aW9uPyAgDQoNCmBgYHtyfQ0KDQpgYGANCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQojIyMgWW91ciBUdXJuIDUgYW5zd2VyICANCg0KYGBge3J9DQp3cV90cmltbWVkICU+JSANCiAgICBncm91cF9ieShzdGF0aW9uX2NvZGUsIG1vbnRoKSAlPiUgDQogICAgc3VtbWFyaXplKG1lYW5fdGVtcCA9IG1lYW4odGVtcCwgbmEucm0gPSBUUlVFKSwNCiAgICAgICAgICAgICAgc2RfdGVtcCA9IHNkKHRlbXAsIG5hLnJtID0gVFJVRSksDQogICAgICAgICAgICAgIG1lYW5fc2FsID0gbWVhbihzYWwsIG5hLnJtID0gVFJVRSksDQogICAgICAgICAgICAgIHNkX3NhbCA9IHNkKHNhbCwgbmEucm0gPSBUUlVFKSkgJT4lIA0KICAgIFZpZXcoKQ0KYGBgDQoNCg0KIyMjIEFzaWRlIC0gbW9yZSBzdW1tYXJpemUgb3B0aW9ucyAgDQoNClRoZXJlIGFyZSBhIGNvdXBsZSBvZiB1c2VmdWwgdmFyaWFudHMgb2YgYHN1bW1hcml6ZWAgZm9yIHNwZWNpYWwgY2FzZXMuIE5vdGUgdGhhdCB5b3UgY2FuIG9ubHkgcGVyZm9ybSBvbmUgc3VtbWFyeSBmdW5jdGlvbiB3aXRoIHRoZXNlIChzbyB5b3UgY291bGRuJ3QgY2FsY3VsYXRlIG1lYW4gKmFuZCogc3RhbmRhcmQgZGV2aWF0aW9uIGluIHRoaXMgd2F5KS4gICAgDQoNCiMjIyMgYHN1bW1hcml6ZV9hbGwoKWAgIA0KDQpBcHBsaWVzIGEgZnVuY3Rpb24gdG8gYWxsIG9mIHRoZSBub24tZ3JvdXBpbmcgdmFyaWFibGVzISAoRXZlbiAiZGF5Iiwgd2hpY2ggaXNuJ3QgbWVhbmluZ2Z1bCwgYnV0IHRoYXQncyBva2F5KSAgDQoNCmBgYHtyfQ0Kd3FfdHJpbW1lZCAlPiUgDQogICAgZ3JvdXBfYnkoc3RhdGlvbl9jb2RlLCBtb250aCkgJT4lIA0KICAgIHN1bW1hcml6ZV9hbGwobWVhbiwgbmEucm0gPSBUUlVFKSAlPiUgDQogICAgVmlldygpDQpgYGANCg0KDQojIyMjIGBzdW1tYXJpemVfYXQoKWAgIA0KDQpUbyBjaG9vc2Ugd2hpY2ggdmFyaWFibGVzIHRvIHN1bW1hcml6ZSAgDQoNCmBgYHtyfQ0Kd3FfdHJpbW1lZCAlPiUgDQogICAgZ3JvdXBfYnkoc3RhdGlvbl9jb2RlLCBtb250aCkgJT4lIA0KICAgIHN1bW1hcml6ZV9hdChjKCJ0ZW1wIiwgInNhbCIpLCBtZWFuLCBuYS5ybSA9IFRSVUUpICU+JSANCiAgICBWaWV3KCkNCmBgYA0KDQoNCiMgU29ydCAgDQoNCg0KWW91IGNhbiBhbHNvIHNvcnQgeW91ciBkYXRhIGZyYW1lIChvciBpdHMgc3VtbWFyeSkgdXNpbmcgYGFycmFuZ2UoKWAuIExldCdzIHB1dCBvdXIgZWJpcmQgc3VtbWFyeSBpbiBvcmRlciBieSBzcGVjaWVzLCB0aGVuIHN0YXRlOiAgDQoNCmBgYHtyfQ0KZWJpcmQgJT4lIA0KICAgIGdyb3VwX2J5KHN0YXRlLCBzcGVjaWVzKSAlPiUgDQogICAgc3VtbWFyaXplKG1lYW5fcHJlc2VuY2UgPSBtZWFuKHByZXNlbmNlLCBuYS5ybSA9IFRSVUUpLA0KICAgICAgICAgICAgICBtYXhfcHJlc2VuY2UgPSBtYXgocHJlc2VuY2UsIG5hLnJtID0gVFJVRSkpICU+JSANCiAgICBhcnJhbmdlKHNwZWNpZXMsIHN0YXRlKSAlPiUgDQogICAgVmlldygpDQpgYGANCg0KDQpPciBwdXQgaXQgaW4gb3JkZXIgYnkgYG1heF9wcmVzZW5jZWA6ICANCg0KYGBge3J9DQplYmlyZCAlPiUgDQogICAgZ3JvdXBfYnkoc3RhdGUsIHNwZWNpZXMpICU+JSANCiAgICBzdW1tYXJpemUobWVhbl9wcmVzZW5jZSA9IG1lYW4ocHJlc2VuY2UsIG5hLnJtID0gVFJVRSksDQogICAgICAgICAgICAgIG1heF9wcmVzZW5jZSA9IG1heChwcmVzZW5jZSwgbmEucm0gPSBUUlVFKSkgJT4lIA0KICAgIGFycmFuZ2UobWF4X3ByZXNlbmNlKSAlPiUgDQogICAgVmlldygpDQpgYGANCg0KDQpJZiB5b3Ugd2FudCB0aGUgaGlnaGVzdCBudW1iZXIgYXQgdGhlIHRvcCBpbnN0ZWFkLCB1c2UgYGRlc2MoKWA6ICANCg0KYGBge3J9DQplYmlyZCAlPiUgDQogICAgZ3JvdXBfYnkoc3RhdGUsIHNwZWNpZXMpICU+JSANCiAgICBzdW1tYXJpemUobWVhbl9wcmVzZW5jZSA9IG1lYW4ocHJlc2VuY2UsIG5hLnJtID0gVFJVRSksDQogICAgICAgICAgICAgIG1heF9wcmVzZW5jZSA9IG1heChwcmVzZW5jZSwgbmEucm0gPSBUUlVFKSkgJT4lIA0KICAgIGFycmFuZ2UoZGVzYyhtYXhfcHJlc2VuY2UpKSAlPiUgDQogICAgVmlldygpDQpgYGANCg0KDQoNCg0KIyMjIFlvdXIgVHVybiA2ICANCg0KVXNlIHRoZSBgd3FfdHJpbW1lZGAgZGF0YSBmcmFtZS4gQ2FsY3VsYXRlIG1vbnRobHkgYXZlcmFnZSB0ZW1wLCBzYWwsIGFuZCBkb19wY3QgKGF0IGxlYXN0IC0gbW9yZSB2YXJpYWJsZXMgaWYgeW91IGxpa2UpICpmb3IgZWFjaCBzdGF0aW9uKi4gTWFrZSBhIHNjYXR0ZXJwbG90IHVzaW5nIGFueSB0d28gb2YgdGhlc2UgdmFyaWFibGVzLiBVc2Ugd2hhdCB5b3UndmUgbGVhcm5lZCBhYm91dCBgZ2dwbG90MmAncyBvcHRpb25zIHRvIGFkanVzdCB0aGUgbG9vayBhbmQgZmVlbCBvZiB0aGUgZ3JhcGguIElzIHRoZSByZWxhdGlvbnNoaXAgd2hhdCB5b3UgZXhwZWN0ZWQgaXQgdG8gYmU/IERvZXMgaXQgdmFyeSBieSBzaXRlPyAgICAgDQoNCmBgYHtyfQ0KDQpgYGANCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KSGVyZSdzIG9uZSBwb3NzaWJsZSB3YXkgdG8gZ28gYWJvdXQgaXQuIFlvdSBjb3VsZCBhbHNvIG1ha2UgYSBuZXcgZGF0YSBmcmFtZSBvZiB0aGUgc3VtbWFyeSB2YXJpYWJsZXMsIGFuZCB1c2UgdGhhdCBpbiBhIHNlcGFyYXRlIGNhbGwgdG8gYGdncGxvdGAuICANCg0KYGBge3J9DQp3cV90cmltbWVkICU+JSANCiAgICBncm91cF9ieShzdGF0aW9uX2NvZGUsIG1vbnRoKSAlPiUgDQogICAgc3VtbWFyaXplX2FsbChtZWFuLCBuYS5ybSA9IFRSVUUpICU+JSANCiAgICBnZ3Bsb3QoKSArDQogICAgZ2VvbV9wb2ludChhZXMoeCA9IHNhbCwgeSA9IGRvX3BjdCwgY29sID0gc3RhdGlvbl9jb2RlKSwgDQogICAgICAgICAgICAgICBzaXplID0gMywgYWxwaGEgPSAwLjMpICsNCiAgICB0aGVtZV9taW5pbWFsKCkgKw0KICAgIGZhY2V0X3dyYXAofnN0YXRpb25fY29kZSkNCmBgYA0KDQojIFJlc2hhcGluZyBkYXRhIHdpdGggYHRpZHlyYA0KDQo8cmlnaHQ+PGJsb2NrcXVvdGUgY2xhc3M9ImJsb2NrcXVvdGUgdGV4dC1yaWdodCI+DQogIDxwIGNsYXNzPSJtYi0wIj5UaWR5IGRhdGEgc2V0cyBhcmUgYWxsIGFsaWtlOyBidXQgZXZlcnkgbWVzc3kgZGF0YSBzZXQgaXMgbWVzc3kgaW4gaXRzIG93biB3YXkuPC9wPg0KICA8Zm9vdGVyIGNsYXNzPSJibG9ja3F1b3RlLWZvb3RlciI+SGFkbGV5IFdpY2toYW0sIDxjaXRlIHRpdGxlPSJTb3VyY2UgVGl0bGUiPlJTdHVkaW88L2NpdGU+PC9mb290ZXI+DQo8L2Jsb2NrcXVvdGU+PC9yaWdodD4NCg0KUnVuIHRoZSBjaHVuayBiZWxvdyB0byAicmVzZXQiIGVhY2ggb2YgdGhlIHRlc3RlciBkYXRhIGZyYW1lcw0KDQpgYGB7cn0NCiMgbG9hZCBhbmQgY2xlYW4gdXAgc29tZSBkYXRhIGZpbGVzIHdlJ3ZlIGFscmVhZHkgYmVlbiB3b3JraW5nIHdpdGgNCmViaXJkIDwtIHJlYWQuY3N2KGhlcmU6OmhlcmUoImRhdGEiLCAiZUJpcmRfd29ya3Nob3AuY3N2IiksIHN0cmluZ3NBc0ZhY3RvcnMgPSBGQUxTRSkNCmViaXJkIDwtIGRwbHlyOjpkaXN0aW5jdChlYmlyZCkNCg0Kd3EgPC0gcmVhZC5jc3YoaGVyZTo6aGVyZSgiZGF0YSIsICJkYWlseV93cS5jc3YiKSwgc3RyaW5nc0FzRmFjdG9ycyA9IEZBTFNFKQ0Kd3FfdHJpbW1lZCA8LSB3cSAlPiUNCiAgICBzZWxlY3Qoc3RhdGlvbl9jb2RlLCBtb250aCwgZGF5LCB0ZW1wLCBzYWwsIGRvX3BjdCwgZGVwdGgpICU+JQ0KICAgIGZpbHRlcighaXMubmEoZGVwdGgpKSAlPiUNCiAgICBtdXRhdGUoZGVwdGhfZnQgPSBkZXB0aCAqIDMuMjgsDQogICAgICAgICAgIHRlbXBfZiA9ICg5LzUpICogdGVtcCArIDMyKQ0KYGBgDQoNCiMjIEV4YW1wbGUgZGF0YQ0KDQp0YWJsZXMgMSwgMiwgMywgNGEsIDRiLCBhbmQgNSBhcmUgYWxsIGJ1aWx0LWluIGRhdGFzZXRzIGluIFIuIFRoZXkgYXJlIGRpZmZlcmVudCB3YXlzIG9mIHJlcHJlc2VudGluZyB0aGUgc2FtZSBkYXRhIGFuZCBhcmUgc3Vic2V0cyBmcm9tIFdvcmxkIEhlYWx0aCBPcmdhbml6YXRpb24gVHViZXJjdWxvc2lzIGRhdGEgYmV0d2VlbiAxOTk5LTIwMDAuDQoNCmBgYHtyfQ0KdGFibGUxDQoNCnRhYmxlMg0KDQpgYGANCg0KR2VuZXJhdGUgInRveSBkYXRhIiB0byBmb2xsb3cgYWxvbmcgd2l0aCB0aGUgc2xpZGVzDQoNCmBgYHtyfQ0KY2FzZXMgPC0gdHJpYmJsZSgNCiAgICB+Q291bnRyeSwgfiIyMDExIiwgfiIyMDEyIiwgfiIyMDEzIiwNCiAgICAiRlIiLCAgICA3MDAwLCAgICA2OTAwLCAgICA3MDAwLA0KICAgICJERSIsICAgIDU4MDAsICAgIDYwMDAsICAgIDYyMDAsDQogICAgIlVTIiwgICAxNTAwMCwgICAxNDAwMCwgICAxMzAwMA0KKQ0KDQpwb2xsdXRpb24gPC0gdHJpYmJsZSgNCiAgICB+Y2l0eSwgfnNpemUsIH5hbW91bnQsDQogICAgIk5ldyBZb3JrIiwgImxhcmdlIiwgICAgICAyMywNCiAgICAiTmV3IFlvcmsiLCAic21hbGwiLCAgICAgIDE0LA0KICAgICJMb25kb24iLCAibGFyZ2UiLCAgICAgIDIyLA0KICAgICJMb25kb24iLCAic21hbGwiLCAgICAgIDE2LA0KICAgICJCZWlqaW5nIiwgImxhcmdlIiwgICAgIDEyMSwNCiAgICAiQmVpamluZyIsICJzbWFsbCIsICAgICAxMjENCikNCmBgYA0KDQojIyMgWW91ciBUdXJuIDcNCg0KKm5vdCBjb2RlKg0KT24gYSBzaGVldCBvZiBwYXBlciwgZHJhdyBob3cgdGhlIGNhc2VzIGRhdGEgc2V0IHdvdWxkIGxvb2sgaWYgaXQgaGFkIHRoZSBzYW1lIHZhbHVlcyBncm91cGVkIGludG8gdGhyZWUgY29sdW1uczogY291bnRyeSwgeWVhciwgbg0KDQoNCiMjIFBpdm90aW5nIGRhdGEgZnJvbSB3aWRlIHRvIGxvbmcgdXNpbmcgYHBpdm90X2xvbmdlcigpYA0KDQpTdGFydCB3aXRoIHRoZSBkYXRhIGZyYW1lIHRvIHJlc2hhcGUuIFRoZW4sIHBpcGUgYCAlPiUgYCB0byB0aGUgYHBpdm90X2xvbmdlcigpYCBmdW5jdGlvbiwgeW91J2xsIGVudGVyIGluZm9ybWF0aW9uIGluIGEgc2VyaWVzIG9mIGFyZ3VtZW50czoNCg0KKyAgY29sczogbnVtZXJpYyBpbmRpY2VzIG9mIGNvbHVtbnMgdG8gY29sbGFwc2UgKG9yIGNhbiBiZSBuYW1lcykNCisgIG5hbWVzX3RvOiBuYW1lIG9mIHRoZSBuZXcga2V5IGNvbHVtbnMgKGEgY2hhcmFjdGVyIHN0cmluZykNCisgIHZhbHVlc190bzogbmFtZSBvZiB0aGUgbmV3IHZhbHVlIGNvbHVtbiAoYSBjaGFyYWN0ZXIgc3RyaW5nKQ0KDQpgYGB7cn0NCiMgdGhlIGNvbHVtbiBpZGVudGlmaWVycyBjYW4gYmUgaW4gYSB2YXJpZXR5IG9mIHdheXM6DQoNCiMgdXNpbmcgdGhlIG51bWVyaWMgaW5kaWNlcyBvZiB0aGUgc3BlY2lmaWMgY29sdW1ucw0KY2FzZXMgJT4lIA0KICBwaXZvdF9sb25nZXIoY29scyA9IDI6NCwgbmFtZXNfdG8gPSAieWVhciIsIHZhbHVlc190byA9ICJuIikNCg0KIyB1c2luZyB0aGUgY29sdW1uIG5hbWVzDQpjYXNlcyAlPiUgDQogIHBpdm90X2xvbmdlcihjb2xzID0gYygiMjAxMSIsICIyMDEyIiwgIjIwMTMiKSwgbmFtZXNfdG8gPSAieWVhciIsIHZhbHVlc190byA9ICJuIikNCg0KIyBvciAiZXZlcnl0aGluZyBleGNlcHQuLi4iDQpjYXNlcyAlPiUgDQogIHBpdm90X2xvbmdlcihjb2xzID0gLUNvdW50cnksIG5hbWVzX3RvID0gInllYXIiLCB2YWx1ZXNfdG8gPSAibiIpDQoNCiMgb3IgZXZlbiBoZWxwZXIgZnVuY3Rpb25zIGxpa2UgJ3N0YXJ0c193aXRoLi4uJw0KY2FzZXMgJT4lIA0KICBwaXZvdF9sb25nZXIoY29scyA9IHN0YXJ0c193aXRoKCIyMDEiKSwgbmFtZXNfdG8gPSAieWVhciIsIHZhbHVlc190byA9ICJuIikNCmBgYA0KDQojIyMgWW91ciBUdXJuIDgNCg0KVXNlIGBwaXZvdF9sb25nZXIoKWAgdG8gcmVvcmdhbml6ZSBgdGFibGU0YWAgaW50byB0aHJlZSBjb2x1bW5zOiBjb3VudHJ5LCB5ZWFyLCBhbmQgY2FzZXMuDQoNCmBgYHtyfQ0KdGFibGU0YSAlPiUgDQogIHRpZHlyOjpwaXZvdF9sb25nZXIoY29scyA9IDI6MywgbmFtZXNfdG8gPSAieWVhciIsIHZhbHVlc190byA9ICJuIikNCg0KYGBgDQoNCg0KIyMgUGl2b3RpbmcgZGF0YSBmcm9tIGxvbmcgdG8gd2lkZSB1c2luZyBgcGl2b3Rfd2lkZXIoKWANCg0KTGlrZSB0aGUgcGl2b3RfbG9uZ2VyKCkgZnVuY3Rpb24gdGhhdCB5b3UgcGlwZSB0bywgcGl2b3Rfd2lkZXIoKSBjb250YWlucyB0d28gbWFpbiBhcmd1bWVudHM6DQoNCisgIG5hbWVzX2Zyb206IGNvbHVtbiB0byB1c2UgZm9yIGtleXMgKGJlY29tZXMgbmV3IHZhcmlhYmxlIGNvbHVtbiBuYW1lcykNCisgIHZhbHVlc19mcm9tOiBjb2x1bW4gdG8gdXNlIGZvciB2YWx1ZXMgKGJlY29tZXMgbmV3IGNvbHVtbiBjZWxscykNCg0KDQpgYGB7cn0NCnBvbGx1dGlvbiAlPiUgDQogIHBpdm90X3dpZGVyKG5hbWVzX2Zyb20gPSBzaXplLCB2YWx1ZXNfZnJvbSA9IGFtb3VudCkNCg0KYGBgDQoNCipOb3RpY2UgdGhhdCBpbiBgcGl2b3Rfd2lkZXIoKWAsIHlvdSBhcmUgcHVsbGluZyBhcmd1bWVudHMgb3V0IGZyb20gdmFyaWFibGVzIGluIHlvdXIgZGF0YS4gVGhlcmVmb3JlLCB0aGV5IGRvIG5vdCBoYXZlIHF1b3RhdGlvbnMgYXJvdW5kIHRoZW0gaW4gdGhlIGNvZGUuKg0KDQojIyMgWW91ciBUdXJuIDkNCg0KVXNlIHBpdm90X3dpZGVyKCkgdG8gcmVvcmdhbml6ZSB0YWJsZTIgaW50byBmb3VyIGNvbHVtbnM6IGNvdW50cnksIHllYXIsIGNhc2VzLCBhbmQgcG9wdWxhdGlvbi4NCg0KYGBge3J9DQp0YWJsZTIgJT4lIA0KICBwaXZvdF93aWRlcihuYW1lc19mcm9tID0gdHlwZSwgdmFsdWVzX2Zyb20gPSBjb3VudCkNCg0KYGBgDQoNCg0KDQoqKioNCioqKg0KKioqDQoNCiMgRXh0cmEgT1lPDQoNCg0KIyMgRGF0ZXMgYW5kIFRpbWVzICANCg0KQmVjYXVzZSB3ZSd2ZSBqdXN0IHdvcmtlZCBhIGxpdHRsZSBiaXQgd2l0aCBtdXRhdGUsIGFuZCBvbmUgb2YgdGhlIHRoaW5ncyB5b3UgbWF5IGZpbmQgeW91cnNlbGYgZG9pbmcgaXMgdHJ5aW5nIHRvIGdldCBkYXRlcyBhbmQgdGltZXMgaW4gdGhlIHJpZ2h0IGZvcm1hdCwgdGhpcyBzZWVtcyBsaWtlIGEgZ29vZCB0aW1lIHRvIHRhY2tsZSBpdC4gV2Ugd2lsbCBtYWtlIHVwIGEgdmVjdG9yIG9mIGRhdGUtbGlrZSB0aGluZ3MgYW5kIGxlYXJuIGhvdyB0byB1c2UgdGhlIGBsdWJyaWRhdGVgIHBhY2thZ2UgdG8gZGVhbCB3aXRoIHRoZW0uICANCg0KYGBge3J9DQpkYXRlc19kZiA8LSBkYXRhLmZyYW1lKGRhdGVzMDEgPSBjKCIxLTEtMjAxOSIsICIxLTItMjAxOSIsICIxLTMtMjAxOSIpLA0KICAgICAgICAgICAgICAgICAgICAgICBkYXRlczAyID0gYygiMS8xLzE5IiwgIjEvMi8xOSIsICIxLzMvMTkiKSwNCiAgICAgICAgICAgICAgICAgICAgICAgZGF0ZXMwMyA9IGMoIjIwMTktMDEtMDEiLCAiMjAxOS0wMS0wMiIsICIyMDE5LTAxLTAzIiksDQogICAgICAgICAgICAgICAgICAgICAgIGRhdGV0aW1lID0gYygiMjAxOS0wMS0wMSAxMjowMCIsICIyMDE5LTAxLTAxIDEzOjAwIiwgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiMjAxOS0wMS0wMSAxNDowMCIpKQ0KDQpgYGANCg0KSG93IGFyZSB0aGVzZSBzaG93aW5nIHVwIGluIHRoZSBkYXRhIGZyYW1lPyAgDQoNCmBgYHtyfQ0KZ2xpbXBzZShkYXRlc19kZikNCmBgYA0KDQpJZiB5b3UgdHJ5IHRvIG1ha2UgYSB0aW1lLXNlcmllcyBncmFwaCwgaXQgbWlnaHQgd29yazsgYnV0IGl0IHdpbGwgYmUgdmVyeSwgdmVyeSBzbG93IHdoZW4geW91IGhhdmUgbW9yZSB0aGFuIDMgdmFsdWVzLiBZb3UgYWxzbyBydW4gdGhlIHJpc2sgb2YgZGF0ZXMgYmVpbmcgc2h1ZmZsZWQgc28gdGhleSdyZSBvdXQgb2Ygb3JkZXIuIFNvIHdlIHJlYWxseSB3YW50IHRob3NlIGRhdGVzIHRvIGJlICpkYXRlcyouICANCg0KVGhpcyBzZWVtcyBsaWtlIGl0IHNob3VsZCBiZSBlYXN5IGluIGJhc2UgUiwgdXNpbmcgdGhlIGBhcy5EYXRlKClgIGZ1bmN0aW9uLCBidXQgdGhhdCBjYW4gZ2l2ZSB5b3UgdGhlIHdyb25nIG91dHB1dCAod2l0aG91dCBzbyBtdWNoIGFzIGEgd2FybmluZyEpIGlmIHlvdXIgZGF0ZSBpc24ndCBmb3JtYXR0ZWQgdGhlIHdheSB0aGUgZnVuY3Rpb24gdGhpbmtzIGl0IHNob3VsZCBiZTogIA0KDQpgYGB7cn0NCmRhdGVzX2RmICU+JSANCiAgICBtdXRhdGUoZGF0ZXMwMV9jaGFuZ2VkID0gYXMuRGF0ZShkYXRlczAxKSwNCiAgICAgICAgICAgZGF0ZXMwMl9jaGFuZ2VkID0gYXMuRGF0ZShkYXRlczAyKSwNCiAgICAgICAgICAgZGF0ZXMwM19jaGFuZ2VkID0gYXMuRGF0ZShkYXRlczAzKSkNCmBgYA0KDQpFbnRlciB0aGUgbHVicmlkYXRlIHBhY2thZ2UuIEl0IGxldHMgeW91IHR1cm4gY2hhcmFjdGVyIHN0cmluZ3MgYW5kIGV2ZW4gbnVtYmVycyBpbnRvIGRhdGVzIC0gb3IgZGF0ZS90aW1lcyEgLSBieSBzcGVjaWZ5aW5nIHRoZSBvcmRlciBvZiB3aGF0J3MgaW4geW91ciBkYXRhIGFzIHRoZSBmdW5jdGlvbiBuYW1lLiAgDQoNClRoYXQncyBoYXJkIHRvIGV4cGxhaW4sIHNvIGxldCdzIGp1c3QgZG8gaXQuIFRoZSBmaXJzdCBjb2x1bW4gaXMgY3VycmVudGx5IGluICJtLWQteSIgKHdpdGggNCBkaWdpdHMgaW4gdGhlIHllYXIpIGZvcm1hdC4gVGhlIHNlY29uZCBpcyAibS9kL3kiIC0gc2ltaWxhciBmb3JtYXQsIGJ1dCBvbmx5IHR3byBkaWdpdHMgaW4gdGhlIHllYXIuIFRoZSBzYW1lIGx1YnJpZGF0ZSBmdW5jdGlvbiB3aWxsIHdvcmsgZm9yIGJvdGggb2YgdGhlc2U6IGBtZHkoKWAuIA0KDQpgYGB7cn0NCmRhdGVzX2RmICU+JSANCiAgICBtdXRhdGUoZGF0ZXMwMV9jaGFuZ2VkID0gbWR5KGRhdGVzMDEpLA0KICAgICAgICAgICBkYXRlczAyX2NoYW5nZWQgPSBtZHkoZGF0ZXMwMikpICU+JSANCiAgICBnbGltcHNlKCkgICMgdG8gc2VlIHRoZSBzdHJ1Y3R1cmUNCmBgYA0KDQpOb3RpY2UgdGhlIHJldHVybmVkIGRhdGUgaXMgInl5eXktbW0tZGQiLCB3aGljaCBpcyBhY3R1YWxseSBhIHN0YW5kYXJkIGRhdGUgZm9ybWF0IGtub3duIGFzIElTTyA4NjAxLiAgDQoNCkZvciBvdXIgM3JkIGNvbHVtbiwgaXQncyBhbHJlYWR5IGluIHRoYXQgb3JkZXIgd2UgbmVlZCwgYnV0IHdlIG5lZWQgaXQgdG8gYmUgYSBkYXRlLiBBbnkgZ3Vlc3NlcyBhcyB0byB3aGF0IHRoYXQgZnVuY3Rpb24gaXM/ICANCg0KYGBge3IsIGV2YWwgPSBGQUxTRX0NCmRhdGVzX2RmICU+JSANCiAgICBtdXRhdGUoZGF0ZXMwMV9jaGFuZ2VkID0gbWR5KGRhdGVzMDEpLA0KICAgICAgICAgICBkYXRlczAyX2NoYW5nZWQgPSBtZHkoZGF0ZXMwMiksDQogICAgICAgICAgIGRhdGVzMDNfY2hhbmdlZCA9IC0tLShkYXRlczAzKSkgJT4lIA0KICAgIGdsaW1wc2UoKQ0KYGBgDQoNCg0KVGltZXMgbWFrZSB0aGluZ3MgdHJpY2tpZXIuIFIgd2FudHMgZGF0ZS10aW1lIGNvbHVtbnMgdG8gYmUgaW4gYSBmb3JtYXQgY2FsbGVkIGBQT1NJWGAuIFRoZXJlIGlzIGEgZnVuY3Rpb24gaW4gYmFzZSBSIGNhbGxlZCBgYXMuUE9TSVhjdCgpYCB0aGF0IGxldHMgeW91IHRyYW5zZm9ybSBkaWZmZXJlbnQgdmFsdWVzIGludG8gdGhhdCBmb3JtYXQuIEl0IGlzIGEgYnVyZGVuIHRob3VnaCB0byBzcGVjaWZ5IHRoZSBmb3JtYXQgeW91J3JlIGZlZWRpbmcgaW50byB0aGUgZnVuY3Rpb24uIChJZiB5b3UgZG9uJ3Qgd2FudCB0byB0YWtlIG15IHdvcmQgZm9yIGl0LCBsb29rIHVwIHRoZSBoZWxwIGZpbGU6ICBgP2FzLlBPU0lYY3RgKQ0KDQpUaGUgbHVicmlkYXRlIHBhY2thZ2UgbWFrZXMgaXQganVzdCBhcyBzaW1wbGUgYXMgdGhlIGRhdGVzIHdlIGRpZCBhYm92ZS4gQWdhaW4sIHRoZSBleGFjdCBmdW5jdGlvbiB5b3Ugd2FudCB0byB1c2UgZGVwZW5kcyBvbiB0aGUgb3JkZXIgeW91ciBkYXRlIGFwcGVhcnMsIGJ1dCBhbGwgeW91IGhhdmUgdG8gZG8gaXMgYWRkIGBfaG1gIG9yIGBfaG1zYCB0byB0aGUgZW5kIG9mIHlvdXIgYG1keWAvYHltZGAgZnVuY3Rpb24sIGRlcGVuZGluZyBvbiB3aGV0aGVyIHlvdXIgdGltZSBoYXMgc2Vjb25kcyBvciBub3QuICANCg0KYGBge3J9DQpkYXRlc19kZiAlPiUgDQogICAgbXV0YXRlKGRhdGVzMDFfY2hhbmdlZCA9IG1keShkYXRlczAxKSwNCiAgICAgICAgICAgZGF0ZXMwMl9jaGFuZ2VkID0gbWR5KGRhdGVzMDIpLA0KICAgICAgICAgICBkYXRlczAzX2NoYW5nZWQgPSB5bWQoZGF0ZXMwMyksDQogICAgICAgICAgIGRhdGV0aW1lX2NoYW5nZWQgPSB5bWRfaG0oZGF0ZXRpbWUpKSAlPiUgDQogICAgZ2xpbXBzZSgpDQpgYGANCg0KDQpJZiB5b3Ugb25seSB3b3JrIHdpdGggdGltZXMgaW4gdGhlaXIgb3duIGNvbHVtbiwgdGhlIGBobXNgIGxpYnJhcnkgbWF5IGhlbHAgeW91IG91dC4gVGhlcmUgYXJlIGRpZmZlcmVuY2VzIGJldHdlZW4gb3BlcmF0aW5nIHN5c3RlbXMgYW5kIHNvZnR3YXJlIHZlcnNpb25zIGluIGhvdyBFeGNlbCBzdG9yZXMgZGF0ZXMgYW5kIHRpbWVzIGluIGl0cyBicmFpbiwgc28gKipiZSBWRVJZIENBUkVGVUwqKiBhbmQgY2hlY2sgeW91ciB0cmFuc2Zvcm1lZCBkYXRhIHRvIG1ha2Ugc3VyZSB5b3UgaGF2ZSB0aGUgb3V0cHV0IHlvdSB0aGluayB5b3UgaGF2ZSEgIA0KDQoNCiMjIyBZb3VyIFR1cm4gLSBEYXRlcyBhbmQgVGltZXMNCg0KYG11dGF0ZWAgY2FuIGJlIHVzZWQgdG8gYWRkIGEgY29tcGxldGUgdmVjdG9yIG9mIHRoZSBzYW1lIHZhbHVlLiBUaGF0IGlzIHdoYXQgd2UnbGwgZG8gYmVsb3cuIEZpbGwgaW4gdGhlIHNrZWxldG9uIGNvZGUgdG8gY3JlYXRlIGEgY29sdW1uIGZvciBhIGZ1bGwgeXl5eS1tbS1kZCBzdHlsZSBkYXRlLCB0aGVuIG1ha2UgYSAqbGluZSogZ3JhcGggb2YgdGVtcGVyYXR1cmUgdGhyb3VnaG91dCB0aGUgeWVhciBhdCB0aGUgd2F0ZXIgcXVhbGl0eSBzdGF0aW9ucywgYW5kIGNvbG9yIHRoZW0gYnkgc3RhdGlvbiBjb2RlLiAgDQoNCldoaWNoIG9mIHRoZXNlIHN0YXRpb25zIGRvIHlvdSB0aGluayBpcyBhdCB0aGUgTkVSUiBpbiBBbGFza2E/ICANCg0KYGBge3IsIGV2YWwgPSBGQUxTRX0NCndxX3RyaW1tZWQgJT4lIA0KICAgIG11dGF0ZSh5ZWFyID0gMjAxNiwNCiAgICAgICAgICAgZGF0ZV9wYXN0ZWQgPSBwYXN0ZSh5ZWFyLCBtb250aCwgZGF5LCBzZXAgPSAiLSIpLA0KICAgICAgICAgICBkYXRlID0gLS0tLShkYXRlX3Bhc3RlZCkpICU+JSAgICMgaGludDogdXNlIGEgbHVicmlkYXRlIGZ1bmN0aW9uIQ0KICAgIGdncGxvdCgpICsNCiAgICBnZW9tXy0tLS0obWFwcGluZyA9IC0tLS0oeCA9IGRhdGUsIHkgPSB0ZW1wX2YsIGNvbCA9IC0tLS0pKQ0KYGBgDQoNCg0KDQoqKiogIA0KKioqICANCioqKg0KDQo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("02-Wrangle.Rmd");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
